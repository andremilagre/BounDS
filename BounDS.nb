(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    217096,       5296]
NotebookOptionsPosition[    207983,       5155]
NotebookOutlinePosition[    208508,       5174]
CellTagsIndexPosition[    208465,       5171]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9664996373455763`*^9, 3.966499640554901*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"2a149feb-678a-4f6c-ab55-ccc17a870748"],

Cell[CellGroupData[{

Cell["Step 1) Chose fields and symmetries", "Section",
 CellChangeTimes->{{3.9664996559036703`*^9, 3.966499665537652*^9}, {
  3.9665369244235373`*^9, 3.966536926706457*^9}, {3.9672661012055798`*^9, 
  3.9672661018353157`*^9}},ExpressionUUID->"28b6a868-4742-4459-844c-\
91af904f030e"],

Cell[TextData[{
 "Pick the number of doublets ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    SubscriptBox["n", "D"],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "f8e4c559-3402-4697-a69a-b6f68199213f"],
 ", the number of charged singlets ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    SubscriptBox["n", "c"],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "28ba2644-ed2f-45b9-b09d-71b7d7a95252"],
 ", and the number of neutral singlets ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    SubscriptBox["n", "n"],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "07613911-7d9c-49b3-9a90-f85ab51c9b5c"]
}], "Text",
 CellChangeTimes->{{3.966499745076453*^9, 3.966499770248146*^9}, {
  3.966499822522727*^9, 
  3.966499882077286*^9}},ExpressionUUID->"291152ed-27b6-4395-a0d9-\
8df4f9ef1b87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nD", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nc", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nn", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQnbFxW1t971tHj8ciHSA6RNJYuwFI60V4gGm5uSGN
TUD6zK8MMP2t/MpUEL2N9xqY/sx8VqwZpM/1pgSI3raorAFE7/4X1QKiLx1n
WgGiT9xJBdMT3loytwLpxRv4eEB0vLFmPoieMU0LTOcpW0q1Aek1y63B9If4
G/2TgPSk8zfBtOgO280gOr3XHkwXXZF/CqLnzVAA06+EH7pc7nvruCTP0xVE
z39e5AWi/zzk9QHRYav7vn8B0uZb94LpR9GGi2ZPeOu46Us4mH6rtUpzDpB2
mr4LTL8uSkwC0Q6iyWA6ze/l6RNA2oPjNZiuZrVXOQukl5c7gOnViyMqPwPp
Y6xRYJq9ZnoDiC7pngGmj2X6GP8G0gd0/cA0AJWz0Ws=
  "],
 CellLabel->"In[8]:=",ExpressionUUID->"8fd86634-1e6a-499d-98c8-1badec29e86f"],

Cell[TextData[{
 "Pick the number of symmetries to be imposed on the scalar potential.\nState \
the transformation properties of the fields \[CapitalPhi][i], \
\[CurlyPhi]P[i], \[Chi][i] under each symmetry group.\nFor group theoretical \
parameters ",
 StyleBox["use Latin characters",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.966499745076453*^9, 3.966499770248146*^9}, {
  3.966499822522727*^9, 3.966499882077286*^9}, {3.966499943776601*^9, 
  3.966500136079933*^9}, {3.96650017304888*^9, 3.966500175001274*^9}, {
  3.966500231915882*^9, 3.966500233238813*^9}, {3.96650556277607*^9, 
  3.966505563664625*^9}},ExpressionUUID->"879793e4-ca59-4a44-a8a5-\
fe2c1c2dd36c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nSym", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sym", "[", "1", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
       RowBox[{"\[CapitalPhi]", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", 
       RowBox[{"-", " ", 
        RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}]}]}], "\[IndentingNewLine]",
      "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assume", "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.966500147507472*^9, 3.966500159690721*^9}, {
   3.966505997743581*^9, 3.966506048167832*^9}, {3.966506389246633*^9, 
   3.9665064195409107`*^9}, {3.966507194718425*^9, 3.966507204545142*^9}, {
   3.966507720794133*^9, 3.966507720848373*^9}, {3.966507897982255*^9, 
   3.966507898031453*^9}, {3.9665080386209993`*^9, 3.9665080776741333`*^9}, {
   3.966508367392232*^9, 3.966508371889578*^9}, {3.966509642604371*^9, 
   3.966509654373354*^9}, {3.966509989526486*^9, 3.966509996646057*^9}, {
   3.966511140142761*^9, 3.966511171621244*^9}, {3.966511246690271*^9, 
   3.966511318195223*^9}, {3.966512013970151*^9, 3.9665120790747766`*^9}, {
   3.966512131067981*^9, 3.9665121675545073`*^9}, {3.966513064605934*^9, 
   3.9665131887370462`*^9}, {3.9665133658893833`*^9, 3.966513398507554*^9}, {
   3.966536956564172*^9, 3.966537065058838*^9}, {3.966537098317419*^9, 
   3.966537098471756*^9}, {3.96653840612648*^9, 3.966538406196334*^9}, {
   3.9665386508612633`*^9, 3.966538655008809*^9}, {3.966538782352754*^9, 
   3.966538859457795*^9}, {3.9665391982920227`*^9, 3.96653923907486*^9}, {
   3.966539563926491*^9, 3.966539626933235*^9}, {3.967195691634226*^9, 
   3.96719569170887*^9}, {3.9672650301286783`*^9, 3.967265051991548*^9}, {
   3.967267500242919*^9, 3.967267511411798*^9}, {3.9672775813619328`*^9, 
   3.9672775822096024`*^9}, 3.968128152304287*^9, {3.9681303339485407`*^9, 
   3.968130333988287*^9}, {3.968131864480303*^9, 3.968131864512019*^9}, {
   3.968222817302099*^9, 3.968222817340989*^9}, {3.968231716336018*^9, 
   3.968231739390068*^9}, {3.9682319228490963`*^9, 3.968231924124058*^9}, {
   3.968304431276984*^9, 3.9683044324942713`*^9}, {3.968310215144849*^9, 
   3.968310260362331*^9}, {3.968310308485237*^9, 3.9683103340067797`*^9}, {
   3.968322071622117*^9, 3.9683221669319*^9}, {3.9683222027089767`*^9, 
   3.968322286979484*^9}, 3.9683223656101522`*^9, {3.968323805052764*^9, 
   3.968323806711726*^9}, {3.968323858983444*^9, 3.968323861686035*^9}, {
   3.9683241773844233`*^9, 3.968324182000407*^9}, {3.9683243148788853`*^9, 
   3.968324316290391*^9}, {3.9683245650534487`*^9, 3.968324566654789*^9}, 
   3.968324609426118*^9, {3.9683248793421087`*^9, 3.968324880599845*^9}, {
   3.96832550327787*^9, 3.968325503342423*^9}, {3.96832554400739*^9, 
   3.968325544424171*^9}, {3.968326044611083*^9, 3.9683260673275223`*^9}, {
   3.968326201385077*^9, 3.968326235994321*^9}, {3.9683262871170263`*^9, 
   3.96832629907309*^9}, {3.96832636050253*^9, 3.968326360545396*^9}, 
   3.968326510058456*^9, {3.968327463357909*^9, 3.968327473373699*^9}, 
   3.968328227819385*^9, {3.968328484116983*^9, 3.9683284868571243`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"7395b977-7b34-4199-9e3d-f44ed9474022"],

Cell[CellGroupData[{

Cell["Resources for Symmetries", "Subsubsection",
 CellChangeTimes->{{3.96832616666273*^9, 
  3.9683261698979607`*^9}},ExpressionUUID->"93fb7b7d-6fbf-42d8-bbb7-\
5ece7b7a7844"],

Cell[TextData[{
 StyleBox["U(1)",
  FontSlant->"Italic"],
 " in 2HDM"
}], "Text",
 CellChangeTimes->{{3.968328080657957*^9, 3.968328087001257*^9}, {
  3.968328162074397*^9, 
  3.968328175451507*^9}},ExpressionUUID->"b7de4ea8-4c16-465e-bf63-\
345f4d6dba9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sym", "[", "1000", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "a"}], "]"}], 
       RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.968328119561666*^9, 3.968328140615623*^9}, {
  3.968328180700529*^9, 3.9683281972977753`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"d37d3dda-a86b-4a21-a88b-de555203e227"],

Cell[TextData[{
 StyleBox["CP4",
  FontSlant->"Italic"],
 " in 3HDM"
}], "Text",
 CellChangeTimes->{{3.968328080657957*^9, 
  3.968328087001257*^9}},ExpressionUUID->"6b84cab6-1722-46f9-b4f3-\
fb0933a68d76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sym", "[", "1000", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", 
      RowBox[{"I", " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"\[CapitalPhi]", "[", "3", "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "3", "]"}], "->", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.968328119561666*^9, 3.968328140615623*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"64aec836-15f0-4165-9374-11883e7060e4"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "13df76f0-ebae-4a5a-857c-1a01713b90e9"],
 " in 2HDM"
}], "Text",
 CellChangeTimes->{{3.968328068745364*^9, 
  3.968328075702104*^9}},ExpressionUUID->"9297344d-d99f-45c1-8962-\
4626d0aa221f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sym", "[", "1000", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", 
      RowBox[{"-", " ", 
       RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sym", "[", "1000", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        RowBox[{"\[CapitalPhi]", "[", "1", "]"}]}], "-", 
       RowBox[{
        FractionBox[
         SqrtBox["3"], "2"], 
        RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", 
      RowBox[{
       RowBox[{
        FractionBox[
         SqrtBox["3"], "2"], 
        RowBox[{"\[CapitalPhi]", "[", "1", "]"}]}], "-", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9683280590932617`*^9, 3.968328064387137*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"961949fd-6a43-4eab-a93e-af3193b4fb97"],

Cell["\[CapitalSigma](36) in 3HDM:", "Text",
 CellChangeTimes->{{3.968326176430955*^9, 3.968326188691339*^9}, {
  3.968326252549719*^9, 
  3.968326252769184*^9}},ExpressionUUID->"1e8ed4ae-a3e5-4a7a-a261-\
1ad9df08e742"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sym", "[", "1000", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", " ", 
      RowBox[{"\[CapitalPhi]", "[", "3", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "3", "]"}], "->", " ", 
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sym", "[", "1000", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
       RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "3", "]"}], "->", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"4", "I", " ", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
       RowBox[{"\[CapitalPhi]", "[", "3", "]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sym", "[", "1000", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "->", 
      RowBox[{
       FractionBox["I", 
        SqrtBox["3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "+", 
         RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "+", 
         RowBox[{"\[CapitalPhi]", "[", "3", "]"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "2", "]"}], "->", 
      RowBox[{
       FractionBox["I", 
        SqrtBox["3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "+", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"4", "I", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
          RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"2", "I", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
          RowBox[{"\[CapitalPhi]", "[", "3", "]"}]}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "3", "]"}], "->", 
      RowBox[{
       FractionBox["I", 
        SqrtBox["3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", "1", "]"}], "+", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"2", "I", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
          RowBox[{"\[CapitalPhi]", "[", "2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"4", "I", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
          RowBox[{"\[CapitalPhi]", "[", "3", "]"}]}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.968326266663808*^9, 3.968326270762722*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"a442e1ad-0fc6-46f3-9800-8fd854518628"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 2) Run this module", "Section",
 CellChangeTimes->{{3.966500256511531*^9, 3.966500272895059*^9}, {
  3.966536929176179*^9, 3.9665369296933393`*^9}, {3.967266103462165*^9, 
  3.967266104026327*^9}},ExpressionUUID->"b5ef7767-43ca-4a65-aefc-\
5f785965c1be"],

Cell[CellGroupData[{

Cell["Redundancy", "Subsubsection",
 CellChangeTimes->{{3.96642433981236*^9, 
  3.9664243417182093`*^9}},ExpressionUUID->"ae217f18-8b51-4364-bece-\
5e7e6102dc4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "\[Lambda]", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Delta]", ",", 
    "\[Gamma]", ",", "\[Zeta]", ",", "\[Kappa]", ",", "\[Lambda]c", ",", 
    "\[Alpha]c", ",", "\[Beta]c", ",", "\[Delta]c", ",", "\[Gamma]c", ",", 
    "\[Zeta]c", ",", "\[Kappa]c"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "redundant", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"redundant", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Lambda]", "[", 
        RowBox[{"c", ",", "d", ",", "a", ",", "b"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"c", ",", "b", ",", "a", ",", "d"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"a", ",", "d", ",", "c", ",", "b"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Beta]", "@@", 
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{"c", ">", "d"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Zeta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Zeta]", "[", 
        RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{"c", ">", "d"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.966424508417754*^9, 3.9664245146054087`*^9}, 
   3.966431770066111*^9, 3.966500291716209*^9, {3.968310086722196*^9, 
   3.9683101027166567`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"ea65aed3-cad6-4346-b770-70b67d77a0a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "conditionsHC", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conditionsHC", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Lambda]", "[", 
        RowBox[{"c", ",", "d", ",", "a", ",", "b"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Lambda]c", "[", 
        RowBox[{"c", ",", "d", ",", "a", ",", "b"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Lambda]c", "[", 
        RowBox[{"b", ",", "a", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", ",", "a", ",", " ", "d", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
         "]"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"d", ",", "c"}], "}"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Lambda]c", "[", 
        RowBox[{"d", ",", "c", ",", "b", ",", "a"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", "c", ",", "b", ",", "a"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
         "]"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"d", ",", "c"}], "}"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"c", ",", "b", ",", "a", ",", "d"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"a", ",", "d", ",", "c", ",", "b"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]c", "[", 
        RowBox[{"c", ",", "b", ",", "a", ",", "d"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]c", "[", 
        RowBox[{"a", ",", "d", ",", "c", ",", "b"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]c", "[", 
        RowBox[{"b", ",", "a", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", ",", "a", ",", " ", "d", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
         "]"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"d", ",", "c"}], "}"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]c", "[", 
        RowBox[{"d", ",", "c", ",", "b", ",", "a"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", "c", ",", "b", ",", "a"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
         "]"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"d", ",", "c"}], "}"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]c", "[", 
        RowBox[{"b", ",", "c", ",", "d", ",", "a"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", ",", "c", ",", "d", ",", "a"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
         "]"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"d", ",", "c"}], "}"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Alpha]c", "[", 
        RowBox[{"d", ",", "a", ",", "b", ",", "c"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", "a", ",", "b", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
         "]"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"d", ",", "c"}], "}"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Beta]", "@@", 
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}]}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Delta]c", "[", 
        RowBox[{"b", ",", "a", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", ",", "a", ",", " ", "d", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
         "]"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{"c", ">", "d"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Gamma]c", "[", 
        RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{"c", ">", "d"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Gamma]c", "[", 
        RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}], "/;", 
       RowBox[{"a", ">", "b"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Zeta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Zeta]", "[", 
        RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{"c", ">", "d"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Zeta]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Zeta]c", "[", 
        RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "/;", 
       RowBox[{"c", ">", "d"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Zeta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"\[Zeta]c", "[", 
        RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}], "/;", 
       RowBox[{"a", ">", "b"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Kappa]", "[", 
         RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}]}], "/;", 
       RowBox[{"a", ">", "b"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Kappa]c", "[", 
         RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}]}], "/;", 
       RowBox[{"a", ">", "b"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9664318153512297`*^9, 3.966431892656188*^9}, 
   3.966431934750822*^9, {3.966432012709218*^9, 3.966432118762398*^9}, {
   3.966432368716494*^9, 3.966432376543996*^9}, {3.966432482005178*^9, 
   3.966432487187293*^9}, {3.966432532745379*^9, 3.9664325820521183`*^9}, {
   3.966432718135023*^9, 3.966432718388226*^9}, {3.96643277388665*^9, 
   3.966432871641367*^9}, {3.9664329090607*^9, 3.9664329392213087`*^9}, {
   3.966433059827057*^9, 3.9664330689289618`*^9}, {3.9664331545369797`*^9, 
   3.966433173040922*^9}, {3.966433217652998*^9, 3.966433218712207*^9}, 
   3.966433284143264*^9, {3.966488764650978*^9, 3.966488798691242*^9}, {
   3.968310094488772*^9, 3.968310100343463*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"de2043ba-81d0-4d18-b95a-bf29fa465d6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Build generic scalar potential", "Subsubsection",
 CellChangeTimes->{{3.961559699304201*^9, 3.9615597041447773`*^9}, {
  3.962101343706236*^9, 3.962101344384425*^9}, {3.9659872495222673`*^9, 
  3.965987250251607*^9}, {3.966505760612657*^9, 
  3.966505763424582*^9}},ExpressionUUID->"d7e3982d-4cf6-4f0b-84e2-\
985760608fda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"couplings", ",", "quad", ",", "term", ",", "VbeforeSym"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.962079843442775*^9, 3.9620798828609333`*^9}, 
   3.962079974414275*^9, {3.9620966771372223`*^9, 3.962096677651479*^9}, {
   3.965987559834174*^9, 3.965987560022346*^9}, {3.965988984727577*^9, 
   3.9659889848381767`*^9}, {3.96599021135819*^9, 3.965990216106165*^9}, {
   3.96599091208775*^9, 3.965990913010583*^9}, {3.965991051107213*^9, 
   3.965991051414629*^9}, 3.9664201856266737`*^9, 3.966424756233423*^9, 
   3.966424824601809*^9, 3.966431781441818*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"9241aab5-f4ba-4ef4-9ff0-e6b3eddd13d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Lambda]", ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nD", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Beta]", ",", 
        RowBox[{"Range", "[", "nn", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "4", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Delta]", ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "5", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Gamma]", ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "6", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Zeta]", ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "7", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Kappa]", ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"couplings", "[", "8", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"\[Kappa]c", ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nD", "]"}], ",", 
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{"Range", "[", "nn", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], ")"}], "//.", 
    "conditionsHC"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.965987331354569*^9, 3.9659873713447104`*^9}, {
   3.9659874255958557`*^9, 3.965987425611507*^9}, {3.96598747160608*^9, 
   3.965987556000762*^9}, 3.966423679989007*^9, {3.9664250734766417`*^9, 
   3.966425073798324*^9}, {3.966431250937559*^9, 3.966431254250621*^9}, {
   3.966431789612547*^9, 3.966431796594379*^9}, {3.966538484295782*^9, 
   3.96653851672902*^9}, {3.9682324786720133`*^9, 3.968232484948901*^9}, {
   3.968233736623156*^9, 3.968233745043709*^9}, {3.968238903610093*^9, 
   3.968238909436157*^9}, {3.968240013895207*^9, 3.968240034580408*^9}, {
   3.968304688118617*^9, 3.968304693170375*^9}, {3.968304754020652*^9, 
   3.9683047597770452`*^9}, {3.9683083593764133`*^9, 3.968308364089508*^9}, {
   3.968308476692325*^9, 3.9683084825312*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"746d7e3a-a70e-4824-a2a5-72e12d00aee4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}], ".", 
         RowBox[{"\[CapitalPhi]", "[", "b", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "c", "]"}], "]"}], ".", 
         RowBox[{"\[CapitalPhi]", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nD"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CurlyPhi]P", "[", "a", "]"}], "]"}], 
         RowBox[{"\[CurlyPhi]P", "[", "b", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CurlyPhi]P", "[", "c", "]"}], "]"}], 
         RowBox[{"\[CurlyPhi]P", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]", "[", "a", "]"}], 
         RowBox[{"\[Chi]", "[", "b", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]", "[", "c", "]"}], 
         RowBox[{"\[Chi]", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "4", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}], ".", 
         RowBox[{"\[CapitalPhi]", "[", "b", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CurlyPhi]P", "[", "c", "]"}], "]"}], 
         RowBox[{"\[CurlyPhi]P", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "5", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}], ".", 
         RowBox[{"\[CapitalPhi]", "[", "b", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]", "[", "c", "]"}], 
         RowBox[{"\[Chi]", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "6", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CurlyPhi]P", "[", "a", "]"}], "]"}], 
         RowBox[{"\[CurlyPhi]P", "[", "b", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]", "[", "c", "]"}], 
         RowBox[{"\[Chi]", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "7", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", "a", "]"}], ".", "\[Sigma]2", ".", 
         RowBox[{"\[CapitalPhi]", "[", "b", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CurlyPhi]P", "[", "c", "]"}], "]"}], 
         RowBox[{"\[Chi]", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quad", "[", "8", "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "b", "]"}], "]"}], ".", "\[Sigma]2", 
         ".", 
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CurlyPhi]P", "[", "c", "]"}], 
         RowBox[{"\[Chi]", "[", "d", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nc"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.965987571366487*^9, 3.965987722343891*^9}, {
   3.965987814704836*^9, 3.965987823620088*^9}, {3.9663406159118977`*^9, 
   3.966340617754884*^9}, 3.966340652970582*^9, 3.966417078595636*^9, 
   3.9664171282807207`*^9, {3.966417722993191*^9, 3.966417766828602*^9}, {
   3.966418157338231*^9, 3.966418163076796*^9}, {3.9664201019983797`*^9, 
   3.9664201051159554`*^9}, {3.966420525741456*^9, 3.966420569565482*^9}, {
   3.966422534025981*^9, 3.966422535767766*^9}, {3.966423097755639*^9, 
   3.966423119158107*^9}, 3.966423685318157*^9, {3.966425071259033*^9, 
   3.966425071697538*^9}, {3.966431261170849*^9, 3.966431264956202*^9}, {
   3.9664880258283253`*^9, 3.966488027269087*^9}, {3.966507442033243*^9, 
   3.9665074516637917`*^9}, 3.9665078303372173`*^9, {3.966592189554432*^9, 
   3.966592221314839*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"e0fe434a-8191-45c3-904c-e42207434299"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "1", "]"}], ".", 
    RowBox[{"quad", "[", "1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "2", "]"}], ".", 
    RowBox[{"quad", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "3", "]"}], ".", 
    RowBox[{"quad", "[", "3", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "4", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "4", "]"}], ".", 
    RowBox[{"quad", "[", "4", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "5", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "5", "]"}], ".", 
    RowBox[{"quad", "[", "5", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "6", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "6", "]"}], ".", 
    RowBox[{"quad", "[", "6", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "7", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "7", "]"}], ".", 
    RowBox[{"quad", "[", "7", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term", "[", "8", "]"}], "=", 
   RowBox[{
    RowBox[{"couplings", "[", "8", "]"}], ".", 
    RowBox[{"quad", "[", "8", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.961557248551119*^9, 3.961557292926484*^9}, 
   3.961557973821321*^9, {3.961558421152505*^9, 3.96155846151193*^9}, {
   3.961558783259832*^9, 3.961558834779379*^9}, {3.9615588875847588`*^9, 
   3.961558894087452*^9}, {3.961558925554818*^9, 3.9615590252150507`*^9}, {
   3.961559078869595*^9, 3.961559205501944*^9}, {3.96155928961311*^9, 
   3.96155934520816*^9}, {3.9615594160096827`*^9, 3.961559441313217*^9}, {
   3.961559559710589*^9, 3.961559587916218*^9}, {3.9615596335593557`*^9, 
   3.9615596521303387`*^9}, {3.96156019024555*^9, 3.9615601925474577`*^9}, {
   3.961560258359976*^9, 3.961560258416737*^9}, 3.961589681042262*^9, 
   3.961589726696681*^9, {3.9620798858447533`*^9, 3.962079917547842*^9}, {
   3.9659874256126213`*^9, 3.9659874256191807`*^9}, {3.965987797889036*^9, 
   3.965987801776883*^9}, {3.965987837773898*^9, 3.965987886775854*^9}, {
   3.966425063492051*^9, 3.966425064218954*^9}, {3.966431270281517*^9, 
   3.96643127988395*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"c2fd99f7-eac7-494c-acb8-0819de2a1d4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VbeforeSym", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"term", "[", "1", "]"}], "+", 
     RowBox[{"term", "[", "2", "]"}], "+", 
     RowBox[{"term", "[", "3", "]"}], "+", 
     RowBox[{"term", "[", "4", "]"}], "+", 
     RowBox[{"term", "[", "5", "]"}], "+", 
     RowBox[{"term", "[", "6", "]"}], "+", 
     RowBox[{"term", "[", "7", "]"}], "+", 
     RowBox[{"term", "[", "8", "]"}]}], "//", "ExpandAll"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.961559660382118*^9, 3.961559681706521*^9}, {
   3.961561685397503*^9, 3.9615616879240932`*^9}, {3.962079924457472*^9, 
   3.962079967998831*^9}, {3.962096669858994*^9, 3.9620966702937813`*^9}, {
   3.9659878904693604`*^9, 3.965987895067576*^9}, {3.965990176244567*^9, 
   3.9659901832562027`*^9}, 3.966423692739847*^9, {3.966424736955648*^9, 
   3.966424747843214*^9}, {3.966424807214081*^9, 3.96642482191634*^9}, {
   3.9664312833464403`*^9, 3.9664312900080833`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"cdef662b-71c9-4286-bbbf-daf908227af2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Apply symmetries", "Subsubsection",
 CellChangeTimes->{{3.962079953323032*^9, 
  3.9620799565969877`*^9}},ExpressionUUID->"3d593310-4b03-4e76-a34d-\
7bcf6eb4cd41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "DotRules", ",", " ", "quadALL", ",", " ", "couplingsALL", ",", 
    "CanonOrder", ",", "VafterSym"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.962102453289259*^9, 3.962102457453617*^9}, {
   3.9621025596956778`*^9, 3.962102559964347*^9}, {3.96598897603356*^9, 
   3.965988976244974*^9}, 3.9659891209329987`*^9, {3.965990588393282*^9, 
   3.965990595994512*^9}, 3.96599106421441*^9, 3.965991695154355*^9, 
   3.966012780237733*^9, 3.966013306786569*^9, 3.966013873108685*^9, 
   3.966014030931369*^9, {3.966500394963872*^9, 3.966500397850617*^9}, {
   3.966505737761174*^9, 3.9665057378694553`*^9}, {3.9683101469031563`*^9, 
   3.968310147123376*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"07c8681d-f216-40ac-b92a-a9aa54ca9780"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DotRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"n_", "*", "x_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"Conjugate", "[", "n", "]"}], "*", " ", 
       RowBox[{"ConjugateTranspose", "[", "x", "]"}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"a_", "+", "b_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", "a", "]"}], "+", 
       RowBox[{"ConjugateTranspose", "[", "b", "]"}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"Conjugate", "[", "x_", "]"}], "]"}], ":>", 
      RowBox[{"Transpose", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"ConjugateTranspose", "[", "x_", "]"}], "]"}], ":>", 
      RowBox[{"Transpose", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"n_", "*", "x_"}], "]"}], ":>", 
      RowBox[{"n", "*", " ", 
       RowBox[{"Transpose", "[", "x", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"n_", "*", "x_"}], ",", "y_"}], "]"}], ":>", 
      RowBox[{"n", "*", 
       RowBox[{"(", 
        RowBox[{"x", ".", "y"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"n_", "*", "y_"}]}], "]"}], ":>", 
      RowBox[{"n", "*", 
       RowBox[{"(", 
        RowBox[{"x", ".", "y"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"a_", "+", "b_"}], ",", "y_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", ".", "y"}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"b", ".", "y"}], ")"}]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"a_", "+", "b_"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", ".", "a"}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"x", ".", "b"}], ")"}]}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], "]"}], ",", 
        RowBox[{"\[CapitalPhi]", "[", "b_", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "b", "]"}], "]"}], ",", 
         RowBox[{"\[CapitalPhi]", "[", "a", "]"}]}], "]"}], "/;", 
       RowBox[{"a", ">", "b"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], "]"}], ",", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[CapitalPhi]", "[", "b_", "]"}], "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"\[CapitalPhi]", "[", "b", "]"}], "]"}], ",", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}]}], "]"}], "/;", 
       RowBox[{"a", ">", "b"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], "]"}], ",", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[CapitalPhi]", "[", "b_", "]"}], "]"}]}], "]"}], ":>", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"\[CapitalPhi]", "[", "b", "]"}], "]"}], ",", 
        RowBox[{"\[CapitalPhi]", "[", "a", "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Abs", "[", "a_", "]"}], "2"], ":>", 
      RowBox[{"a", "*", 
       RowBox[{"Conjugate", "[", "a", "]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.966495082555913*^9, 3.96649508293818*^9}, {
   3.966500404806638*^9, 3.966500404911515*^9}, {3.9665064826073637`*^9, 
   3.966506487745599*^9}, {3.966507168534515*^9, 3.966507170027186*^9}, 
   3.966507487648573*^9, {3.966508475774415*^9, 3.9665084762777557`*^9}, {
   3.966508520972528*^9, 3.966508537357646*^9}, 3.966508651606612*^9, {
   3.9665087194370613`*^9, 3.966508722107909*^9}, {3.966508985751204*^9, 
   3.9665090461562767`*^9}, {3.9665091228107243`*^9, 
   3.9665091806222258`*^9}, {3.966509247169244*^9, 3.966509267317359*^9}, {
   3.9665374806598053`*^9, 3.966537556693492*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"81fa116a-af6e-4e00-b80b-14cfcd2ba577"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"quadALL", "=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"quad", "[", "1", "]"}], ",", 
       RowBox[{"quad", "[", "2", "]"}], ",", 
       RowBox[{"quad", "[", "3", "]"}], ",", 
       RowBox[{"quad", "[", "4", "]"}], ",", 
       RowBox[{"quad", "[", "5", "]"}], ",", 
       RowBox[{"quad", "[", "6", "]"}], ",", 
       RowBox[{"quad", "[", "7", "]"}], ",", 
       RowBox[{"quad", "[", "8", "]"}]}], "]"}], "//", "DeleteDuplicates"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"couplingsALL", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"couplings", "[", "1", "]"}], ",", 
      RowBox[{"couplings", "[", "2", "]"}], ",", 
      RowBox[{"couplings", "[", "3", "]"}], ",", 
      RowBox[{"couplings", "[", "4", "]"}], ",", 
      RowBox[{"couplings", "[", "5", "]"}], ",", 
      RowBox[{"couplings", "[", "6", "]"}], ",", 
      RowBox[{"couplings", "[", "7", "]"}], ",", 
      RowBox[{"couplings", "[", "8", "]"}]}], "]"}], "//", 
    "DeleteDuplicates"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.965990637497148*^9, 3.965990640797475*^9}, 
   3.966013959460641*^9, {3.96649512218217*^9, 3.9664951631753817`*^9}, {
   3.966500404020258*^9, 3.9665004112824917`*^9}, 3.96650668286489*^9, 
   3.9665067187670507`*^9, {3.9665079056081963`*^9, 3.966507907631497*^9}, {
   3.966537319603971*^9, 3.966537322020817*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"a7fd7cc7-1ad9-4a64-9ffb-58d553b5cab2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CanonOrder", "[", "rules_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"order", ",", "oriented", ",", "groups"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Step", " ", "1"}], ":", 
      RowBox[{
      "orient", " ", "each", " ", "rule", " ", "so", " ", "the", " ", 
       "smallest", " ", "index", " ", "pattern", " ", "is", " ", "on", " ", 
       "RHS"}]}], "*)"}], 
    RowBox[{
     RowBox[{
      RowBox[{"order", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"OrderedQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"List", "@@", "a"}], ",", 
         RowBox[{"List", "@@", "b"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oriented", "=", 
      RowBox[{"rules", "/.", " ", 
       RowBox[{"r_Rule", ":>", 
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"order", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"r", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "->", 
            RowBox[{"r", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "r"}], "]"}], ")"}]}]}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Step", " ", "2"}], ":", 
        RowBox[{"handle", " ", "duplicate", " ", "LHSs"}], ":", 
        RowBox[{
         RowBox[{"leave", " ", "one", " ", "as"}], "-", "is"}]}], ",", " ", 
       RowBox[{"flip", " ", "the", " ", "rest"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"groups", "=", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"oriented", ",", "First"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "g", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "->", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}], "/@", 
              RowBox[{"Rest", "[", "g", "]"}]}]}], "]"}], ",", "g"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"g", ",", "groups"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.968309792123027*^9, 3.9683097921251163`*^9}, {
  3.968309857255659*^9, 3.96830994855729*^9}, {3.968310028772975*^9, 
  3.968310039518487*^9}, {3.968310151872752*^9, 3.968310155803545*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"d1be6d5d-48e1-4dc2-a870-72ffb0fd52d9"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ll", ",", "Vtemp", ",", "coeffs", ",", "eqs", ",", "subs"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Vtemp", "[", "1", "]"}], "=", "VbeforeSym"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ll", "=", "1"}], ",", 
      RowBox[{"ll", "<=", "nSym"}], ",", " ", 
      RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Vtemp", "[", 
         RowBox[{"ll", "+", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Vtemp", "[", "ll", "]"}], "/.", 
          RowBox[{"Sym", "[", "ll", "]"}]}], "//", "Distribute"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Vtemp", "[", 
         RowBox[{"ll", "+", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Vtemp", "[", 
           RowBox[{"ll", "+", "1"}], "]"}], "//.", "DotRules"}], "//", 
         "ExpandAll"}]}], ";", 
       RowBox[{
        RowBox[{"Vtemp", "[", 
         RowBox[{"ll", "+", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Vtemp", "[", 
           RowBox[{"ll", "+", "1"}], "]"}], "//", 
          RowBox[{
           RowBox[{"Collect", "[", 
            RowBox[{"#", ",", "quadALL"}], "]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"#", ",", "Assume"}], "]"}], "&"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coeffs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"Vtemp", "[", "ll", "]"}], "-", 
              RowBox[{"Vtemp", "[", 
               RowBox[{"ll", "+", "1"}], "]"}]}], "]"}], ",", "#"}], "]"}], 
          "&"}], "/@", "quadALL"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coeffs", "=", 
        RowBox[{
         RowBox[{"coeffs", "//", "ExpandAll"}], "//", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"#", ",", "Assume"}], "]"}], "&"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqs", "=", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"coeffs", "==", "0"}], "]"}], "//", "DeleteDuplicates"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"subs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{"eqs", ",", "couplingsALL"}], "]"}], "//", "Flatten"}], "//", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"#", ",", "Assume"}], "]"}], "&"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subs", "=", 
        RowBox[{"CanonOrder", "[", "subs", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "subs", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Vtemp", "[", 
         RowBox[{"ll", "+", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Vtemp", "[", "ll", "]"}], "//.", "subs"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"VafterSym", "=", 
     RowBox[{"Vtemp", "[", 
      RowBox[{"nSym", "+", "1"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9659891799233437`*^9, 3.965989319291377*^9}, {
   3.965989417253528*^9, 3.965989527898719*^9}, {3.9659895870366793`*^9, 
   3.965989588260483*^9}, {3.9659896242030277`*^9, 3.9659896328204536`*^9}, {
   3.965989667780217*^9, 3.9659897067613277`*^9}, {3.965989763313397*^9, 
   3.9659897960192957`*^9}, {3.965989884197898*^9, 3.965989885362948*^9}, 
   3.96599064574267*^9, 3.96599084543477*^9, 3.965990892122205*^9, {
   3.965990926566925*^9, 3.965990950759781*^9}, 3.965991035523724*^9, {
   3.9659910891243563`*^9, 3.965991095847334*^9}, 3.965991170304541*^9, {
   3.965991416433913*^9, 3.965991418942986*^9}, {3.9659914804714603`*^9, 
   3.965991480759925*^9}, 3.965991975506434*^9, {3.9659921247416573`*^9, 
   3.965992129205512*^9}, {3.966012024224876*^9, 3.966012037837551*^9}, {
   3.966012697784892*^9, 3.9660127393278923`*^9}, {3.966012902212219*^9, 
   3.9660129556515512`*^9}, 3.966013118728095*^9, {3.9660131971115837`*^9, 
   3.966013248975897*^9}, {3.966013328154605*^9, 3.966013329638073*^9}, 
   3.9660135241090593`*^9, 3.966013680856283*^9, {3.966013741390819*^9, 
   3.966013743400703*^9}, {3.966013842003994*^9, 3.966013856879266*^9}, {
   3.9660139754566803`*^9, 3.966013975769537*^9}, {3.96601402093536*^9, 
   3.966014025720202*^9}, 3.966014743236985*^9, {3.966016125150147*^9, 
   3.966016139389275*^9}, {3.966016345460807*^9, 3.966016349697133*^9}, {
   3.9660164102503347`*^9, 3.966016414802822*^9}, 3.966016897642209*^9, {
   3.966018451038865*^9, 3.966018470311109*^9}, 3.966018521703841*^9, {
   3.966018559534685*^9, 3.9660185787004766`*^9}, {3.966233037743658*^9, 
   3.966233037882208*^9}, {3.966233123144886*^9, 3.966233123243065*^9}, {
   3.9662331612105513`*^9, 3.966233161982312*^9}, {3.9662332817421083`*^9, 
   3.966233281884726*^9}, {3.966233640636569*^9, 3.966233641052866*^9}, {
   3.9662336814021063`*^9, 3.966233695709467*^9}, {3.966233729073462*^9, 
   3.9662337419644814`*^9}, {3.96623450818392*^9, 3.966234514299357*^9}, {
   3.966234637700033*^9, 3.966234638288631*^9}, 3.966234732436494*^9, {
   3.966234769802725*^9, 3.966234785814004*^9}, 3.966235589986475*^9, {
   3.9662356254931717`*^9, 3.966235673181734*^9}, {3.966235739192824*^9, 
   3.9662357457232513`*^9}, {3.966235782552524*^9, 3.966235796661776*^9}, 
   3.9662360249022207`*^9, {3.9662361102014427`*^9, 3.96623612069456*^9}, 
   3.966327894049158*^9, {3.966328535051485*^9, 3.966328539752054*^9}, {
   3.966339721709908*^9, 3.9663397429370413`*^9}, 3.9664158635496798`*^9, 
   3.966415918645072*^9, 3.966418018280086*^9, {3.966418482283391*^9, 
   3.966418482931829*^9}, {3.966488148640812*^9, 3.966488163720298*^9}, {
   3.9664895829429417`*^9, 3.966489584557993*^9}, {3.9664898321073713`*^9, 
   3.966489836557254*^9}, {3.966490414660413*^9, 3.966490631614175*^9}, {
   3.966490884877738*^9, 3.966490890903735*^9}, {3.966495197450673*^9, 
   3.966495203283276*^9}, {3.966500428200189*^9, 3.966500443099133*^9}, {
   3.966505807529743*^9, 3.966505813749056*^9}, {3.966505856436173*^9, 
   3.9665058658022327`*^9}, {3.966505919781488*^9, 3.966505979273024*^9}, {
   3.966506077975209*^9, 3.966506089823435*^9}, {3.966506121401705*^9, 
   3.966506127583603*^9}, {3.966506173205049*^9, 3.9665061736415243`*^9}, 
   3.9665063059477654`*^9, {3.966506411888835*^9, 3.966506412897848*^9}, 
   3.966506544351727*^9, {3.966506610634076*^9, 3.966506615068322*^9}, {
   3.966506801322123*^9, 3.9665068161120453`*^9}, {3.966506920441571*^9, 
   3.966506922770396*^9}, {3.966507531599608*^9, 3.9665075607497263`*^9}, {
   3.966507921074348*^9, 3.966507936198518*^9}, {3.966508095208591*^9, 
   3.966508096676749*^9}, {3.9665082301359243`*^9, 3.966508239252028*^9}, {
   3.966508320369903*^9, 3.96650832766868*^9}, {3.9665088928184757`*^9, 
   3.9665088997243137`*^9}, {3.966509197466145*^9, 3.966509204952426*^9}, {
   3.966509289582111*^9, 3.966509372910017*^9}, {3.9665098986656733`*^9, 
   3.966509898807583*^9}, 3.966512180841485*^9, {3.966512296160293*^9, 
   3.966512317369071*^9}, 3.966512381992156*^9, {3.9665124766296787`*^9, 
   3.9665124800832977`*^9}, {3.966537134016303*^9, 3.9665372447385693`*^9}, {
   3.966537341580406*^9, 3.966537371643085*^9}, {3.966537403902584*^9, 
   3.966537446756838*^9}, {3.966537599143819*^9, 3.966537697369021*^9}, {
   3.966537749836733*^9, 3.9665377600235043`*^9}, {3.966537822029667*^9, 
   3.966537829375367*^9}, {3.966537863176468*^9, 3.96653790108528*^9}, {
   3.966537943929329*^9, 3.966537990205977*^9}, 3.966538041163197*^9, 
   3.966538148762845*^9, {3.9665383180092363`*^9, 3.966538330377244*^9}, {
   3.9665384446332903`*^9, 3.966538444681444*^9}, 3.966538537372871*^9, 
   3.96653858441926*^9, {3.9665387142383432`*^9, 3.96653873665248*^9}, {
   3.966538909120204*^9, 3.966538913971641*^9}, 3.9682325203949337`*^9, {
   3.9682368366569643`*^9, 3.968236844701962*^9}, 3.968237036627097*^9, 
   3.968237076735875*^9, {3.968304388797826*^9, 3.9683044054166107`*^9}, 
   3.9683055066496058`*^9, {3.968306947949184*^9, 3.968306966601345*^9}, {
   3.968307016406827*^9, 3.968307021271769*^9}, {3.968307082121615*^9, 
   3.968307114924561*^9}, {3.968307188196847*^9, 3.968307190732006*^9}, {
   3.9683072297375183`*^9, 3.968307235109638*^9}, {3.9683073692632*^9, 
   3.968307385945101*^9}, 3.9683081025479794`*^9, {3.968308520009693*^9, 
   3.968308520326445*^9}, {3.968308960047214*^9, 3.968308963757793*^9}, {
   3.9683091811061583`*^9, 3.968309182812191*^9}, {3.968309496722537*^9, 
   3.968309500456028*^9}, {3.96830980975443*^9, 3.968309812278881*^9}, 
   3.968310052189958*^9, {3.9683101600202427`*^9, 3.9683101603033323`*^9}, 
   3.968322309136964*^9, 3.968322399598815*^9, 3.968324157951851*^9, 
   3.9683242793009167`*^9, 3.968324677136174*^9, 3.968324851625331*^9, {
   3.968324883641921*^9, 3.9683249055771008`*^9}, 3.968325276197074*^9, 
   3.968325319738454*^9, {3.9683263902508*^9, 3.968326395139772*^9}, 
   3.968327270078506*^9, 3.968327536811599*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"28565d23-0e86-4610-b632-2054c7248310"]
}, Closed]],

Cell[CellGroupData[{

Cell["Expand doublets and rewrite the scalar potential", "Subsubsection",
 CellChangeTimes->{{3.9615724756809797`*^9, 3.961572476593533*^9}, {
  3.961572808940679*^9, 3.961572810150866*^9}, {3.96599023520897*^9, 
  3.965990265117847*^9}, {3.966500639020307*^9, 
  3.9665006631134644`*^9}},ExpressionUUID->"e8a6ee27-fb06-401f-a1be-\
9872c3c962a4"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "VVV", ",", "state", ",", "statec", ",", "SM", ",", "SM11", ",", "SM12", 
   ",", "SM21", ",", "SM22", ",", "stateP1", ",", "stateP1c", ",", "stateP2", 
   ",", "stateP2c"}], "]"}]], "Input",
 CellChangeTimes->{{3.961572482481195*^9, 3.961572488148037*^9}, {
   3.961572553780958*^9, 3.961572554266121*^9}, 3.965991119413134*^9, {
   3.9659912352146*^9, 3.965991265591866*^9}, {3.966012762758521*^9, 
   3.966012763421072*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"574b08c4-cd93-4595-b076-5a75dba5ff7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandDoublets", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], ":>", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]P", "[", "a", "]"}], ",", 
        RowBox[{"\[Phi]0", "[", "a", "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], "]"}], ":>", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]M", "[", "a", "]"}], ",", 
        RowBox[{"\[Phi]0c", "[", "a", "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]2", ":>", 
      RowBox[{"(", GridBox[{
         {"0", 
          RowBox[{"-", "I"}]},
         {"I", "0"}
        }], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"\[CurlyPhi]P", "[", "a_", "]"}], "]"}], ":>", 
      RowBox[{"\[CurlyPhi]M", "[", "a", "]"}]}]}], " ", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9664177927461033`*^9, 3.966417845851797*^9}, {
   3.966418400546095*^9, 3.966418402262748*^9}, {3.966419964663024*^9, 
   3.966419975797183*^9}, {3.966420074093299*^9, 3.966420075331381*^9}, {
   3.966420341027412*^9, 3.966420342898539*^9}, {3.966420581978524*^9, 
   3.9664205940122757`*^9}, {3.96642079300079*^9, 3.966420794802128*^9}, {
   3.966422089816915*^9, 3.966422090904372*^9}, {3.9664225658135357`*^9, 
   3.9664225771573067`*^9}, {3.96642314819033*^9, 3.966423152576639*^9}, {
   3.966423245922324*^9, 3.966423246624*^9}, {3.9664949648974943`*^9, 
   3.966494967317877*^9}, 3.966507659876574*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"aebacfe3-b370-4b78-b646-bf58bde1c687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VVV", "=", 
   RowBox[{
    RowBox[{"VafterSym", "//.", "ExpandDoublets"}], "//.", "conditionsHC"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.965990122696064*^9, 3.965990123653717*^9}, {
   3.966012750778368*^9, 3.966012751137615*^9}, 3.96601418027009*^9, 
   3.966233928129053*^9, {3.966417850496356*^9, 3.966417851251994*^9}, 
   3.9664184054292088`*^9, 3.966420059997273*^9, 3.966420883588993*^9, {
   3.966431949922697*^9, 3.966431950873563*^9}, 3.9665006831880302`*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"c5cbf77b-9e9a-4c4b-a4de-4a291b2a43cd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scattering matrix |2, 2, 0\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.961559711781605*^9, 3.961559716408942*^9}, {
  3.9615663633592*^9, 3.9615663698443947`*^9}, {3.965814662843253*^9, 
  3.9658146694571257`*^9}, {3.965815001918058*^9, 3.965815002907009*^9}, {
  3.966500869339765*^9, 
  3.966500875379957*^9}},ExpressionUUID->"8513b58f-51c3-49eb-af20-\
8fba35809409"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"state", "[", 
    RowBox[{"2", ",", "2", ",", "0"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CurlyPhi]P", "[", "i", "]"}], ",", 
          RowBox[{"\[CurlyPhi]P", "[", "j", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nc"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "i", ",", "nc"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"statec", "[", 
     RowBox[{"2", ",", "2", ",", "0"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[CurlyPhi]M", "[", "i", "]"}], ",", 
           RowBox[{"\[CurlyPhi]M", "[", "j", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nc"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", "nc"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SM", "[", 
    RowBox[{"2", ",", "2", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ssd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"state", "[", 
         RowBox[{"2", ",", "2", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ssd", "=", 
        RowBox[{"statec", "[", 
         RowBox[{"2", ",", "2", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"VVV", ",", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"ssd", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["2"]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["2"]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ssd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
     "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.961557362087435*^9, 3.9615573818082523`*^9}, {
   3.961557429456059*^9, 3.961557466301087*^9}, {3.9615575519532948`*^9, 
   3.961557596061483*^9}, {3.9615621754682007`*^9, 3.961562194233508*^9}, 
   3.961562227897045*^9, {3.961562263421062*^9, 3.961562333385951*^9}, {
   3.9615623664990883`*^9, 3.961562465043407*^9}, {3.961562504430759*^9, 
   3.961562539568851*^9}, {3.9615626332127113`*^9, 3.961562643044835*^9}, {
   3.961562868980578*^9, 3.9615628851829863`*^9}, {3.961562942630371*^9, 
   3.961563028659017*^9}, {3.9615631099213753`*^9, 3.961563112368203*^9}, {
   3.961563175410603*^9, 3.961563186995729*^9}, {3.9615634037106857`*^9, 
   3.9615634764599533`*^9}, {3.961563528568614*^9, 3.961563533278542*^9}, {
   3.9615636335045033`*^9, 3.961563639439384*^9}, {3.961564978831091*^9, 
   3.961564979291746*^9}, {3.961565083924752*^9, 3.9615650980337753`*^9}, {
   3.961565158819345*^9, 3.9615652117825108`*^9}, {3.961565250742722*^9, 
   3.961565346459837*^9}, {3.961565380678731*^9, 3.961565382107504*^9}, {
   3.961565434513001*^9, 3.961565470882923*^9}, {3.961565536758751*^9, 
   3.961565570507143*^9}, {3.961565680424222*^9, 3.961565797230665*^9}, 
   3.961565863837698*^9, 3.961565944261169*^9, {3.9615659963297367`*^9, 
   3.961565998271183*^9}, {3.961566036441738*^9, 3.961566105937653*^9}, {
   3.961566140804175*^9, 3.9615661990433207`*^9}, {3.9615662415871687`*^9, 
   3.961566269553461*^9}, {3.961566891422708*^9, 3.961566895039761*^9}, {
   3.961572150385412*^9, 3.9615721534469013`*^9}, {3.9615724566780033`*^9, 
   3.961572459131673*^9}, {3.961572516623362*^9, 3.961572558934911*^9}, {
   3.961577047958794*^9, 3.9615770520342207`*^9}, {3.9646851967949677`*^9, 
   3.964685199659182*^9}, {3.9658180630124207`*^9, 3.965818063538959*^9}, 
   3.9663949130912867`*^9, {3.966501065714522*^9, 3.966501069824956*^9}, {
   3.966501100091207*^9, 3.966501101571308*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"2af6e305-eeb2-40ca-ad82-9cead9efdca5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scattering matrix |2, 3/2, 1/2\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.961559711781605*^9, 3.961559716408942*^9}, {
   3.9615663633592*^9, 3.961566376149317*^9}, {3.965814906446916*^9, 
   3.96581492979987*^9}, 
   3.966500878727751*^9},ExpressionUUID->"911bda91-4bea-4913-a86a-\
b74b41a4a8f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"state", "[", 
    RowBox[{"2", ",", 
     RowBox[{"3", "/", "2"}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]P", "[", "i", "]"}], ",", 
          RowBox[{"\[CurlyPhi]P", "[", "j", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"statec", "[", 
     RowBox[{"2", ",", 
      RowBox[{"3", "/", "2"}], ",", 
      RowBox[{"1", "/", "2"}]}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]M", "[", "i", "]"}], ",", 
           RowBox[{"\[CurlyPhi]M", "[", "j", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SM", "[", 
    RowBox[{"2", ",", 
     RowBox[{"3", "/", "2"}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ssd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"state", "[", 
         RowBox[{"2", ",", 
          RowBox[{"3", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ssd", "=", 
        RowBox[{"statec", "[", 
         RowBox[{"2", ",", 
          RowBox[{"3", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"VVV", ",", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"ssd", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ssd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
     "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.961557362087435*^9, 3.9615573818082523`*^9}, {
   3.961557429456059*^9, 3.961557466301087*^9}, {3.9615575519532948`*^9, 
   3.961557596061483*^9}, {3.9615621754682007`*^9, 3.961562194233508*^9}, 
   3.961562227897045*^9, {3.961562263421062*^9, 3.961562333385951*^9}, {
   3.9615623664990883`*^9, 3.961562465043407*^9}, {3.961562504430759*^9, 
   3.961562539568851*^9}, {3.9615626332127113`*^9, 3.961562643044835*^9}, {
   3.961562868980578*^9, 3.9615628851829863`*^9}, {3.961562942630371*^9, 
   3.961563028659017*^9}, {3.9615631099213753`*^9, 3.961563112368203*^9}, {
   3.961563175410603*^9, 3.961563186995729*^9}, {3.9615634037106857`*^9, 
   3.9615634764599533`*^9}, {3.961563528568614*^9, 3.961563533278542*^9}, {
   3.9615636335045033`*^9, 3.961563639439384*^9}, {3.961564978831091*^9, 
   3.961564979291746*^9}, {3.961565083924752*^9, 3.9615650980337753`*^9}, {
   3.961565158819345*^9, 3.9615652117825108`*^9}, {3.961565250742722*^9, 
   3.961565346459837*^9}, {3.961565380678731*^9, 3.961565382107504*^9}, {
   3.961565434513001*^9, 3.961565470882923*^9}, {3.961565536758751*^9, 
   3.961565570507143*^9}, {3.961565680424222*^9, 3.961565797230665*^9}, 
   3.961565863837698*^9, 3.961565944261169*^9, {3.9615659963297367`*^9, 
   3.961565998271183*^9}, {3.961566036441738*^9, 3.961566105937653*^9}, {
   3.961566140804175*^9, 3.9615661990433207`*^9}, {3.9615662415871687`*^9, 
   3.961566269553461*^9}, {3.961566379204405*^9, 3.961566383271199*^9}, {
   3.96156641351088*^9, 3.961566460213718*^9}, {3.9615668194916563`*^9, 
   3.9615668622000523`*^9}, {3.9615669565903378`*^9, 3.961566956629999*^9}, {
   3.961572572989588*^9, 3.961572593058648*^9}, {3.961578861265089*^9, 
   3.96157886237761*^9}, {3.961578932763297*^9, 3.961578934017683*^9}, {
   3.964685233645214*^9, 3.964685239839388*^9}, {3.965818058278243*^9, 
   3.96581805883536*^9}, {3.965987425621069*^9, 3.9659874256215754`*^9}, 
   3.966394909184968*^9, {3.9665010806842937`*^9, 3.966501087434621*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"faa7b341-a854-47a1-8922-703cb6b8f938"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scattering matrix |2, 1, 1\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.961559711781605*^9, 3.961559716408942*^9}, {
   3.9615663633592*^9, 3.9615663698443947`*^9}, {3.9615664873953047`*^9, 
   3.961566487453567*^9}, {3.9658149966476507`*^9, 3.965815000724824*^9}, 
   3.966500879700511*^9},ExpressionUUID->"6bcf5a2b-8114-4134-84ad-\
b8f48ced84bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"state", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]P", "[", "i", "]"}], ",", 
          RowBox[{"\[Phi]P", "[", "j", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "i", ",", "nD"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"statec", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]M", "[", "i", "]"}], ",", 
           RowBox[{"\[Phi]M", "[", "j", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", "nD"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SM", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ssd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"state", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ssd", "=", 
        RowBox[{"statec", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"VVV", ",", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"ssd", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["2"]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["2"]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ssd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
     "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.961557362087435*^9, 3.9615573818082523`*^9}, {
   3.961557429456059*^9, 3.961557466301087*^9}, {3.9615575519532948`*^9, 
   3.961557596061483*^9}, {3.9615621754682007`*^9, 3.961562194233508*^9}, 
   3.961562227897045*^9, {3.961562263421062*^9, 3.961562333385951*^9}, {
   3.9615623664990883`*^9, 3.961562465043407*^9}, {3.961562504430759*^9, 
   3.961562539568851*^9}, {3.9615626332127113`*^9, 3.961562643044835*^9}, {
   3.961562868980578*^9, 3.9615628851829863`*^9}, {3.961562942630371*^9, 
   3.961563028659017*^9}, {3.9615631099213753`*^9, 3.961563112368203*^9}, {
   3.961563175410603*^9, 3.961563186995729*^9}, {3.9615634037106857`*^9, 
   3.9615634764599533`*^9}, {3.961563528568614*^9, 3.961563533278542*^9}, {
   3.9615636335045033`*^9, 3.961563639439384*^9}, {3.961564978831091*^9, 
   3.961564979291746*^9}, {3.961565083924752*^9, 3.9615650980337753`*^9}, {
   3.961565158819345*^9, 3.9615652117825108`*^9}, {3.961565250742722*^9, 
   3.961565346459837*^9}, {3.961565380678731*^9, 3.961565382107504*^9}, {
   3.961565434513001*^9, 3.961565470882923*^9}, {3.961565536758751*^9, 
   3.961565570507143*^9}, {3.961565680424222*^9, 3.961565797230665*^9}, 
   3.961565863837698*^9, 3.961565944261169*^9, {3.9615659963297367`*^9, 
   3.961565998271183*^9}, {3.961566036441738*^9, 3.961566105937653*^9}, {
   3.961566140804175*^9, 3.9615661990433207`*^9}, {3.9615662415871687`*^9, 
   3.961566269553461*^9}, {3.961566490223823*^9, 3.961566498893268*^9}, {
   3.961566566596243*^9, 3.9615666580127296`*^9}, {3.961566733998996*^9, 
   3.9615668158167067`*^9}, {3.961566981391708*^9, 3.961566981456579*^9}, 
   3.961572157985334*^9, {3.961572599172604*^9, 3.961572622761465*^9}, {
   3.964685244794654*^9, 3.96468524943539*^9}, {3.9658180509052753`*^9, 
   3.965818051469239*^9}, {3.965987425622796*^9, 3.965987425625657*^9}, 
   3.966394903645743*^9, {3.966501112295018*^9, 3.966501120376071*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"8d0857e3-528a-404c-b93e-0245be63ed75"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scattering matrix |1, 1, 0\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.961559711781605*^9, 3.961559716408942*^9}, {
   3.9615663633592*^9, 3.961566376149317*^9}, {3.961570020404307*^9, 
   3.961570020454726*^9}, 3.961571082281945*^9, {3.965815043741815*^9, 
   3.9658150470128*^9}, 
   3.966500880947648*^9},ExpressionUUID->"7ffa1256-248f-4b17-b47b-\
12c2dfdf6581"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stateP1", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]P", "[", "#1", "]"}], ",", 
       RowBox[{"\[Phi]0", "[", "#2", "]"}]}], "}"}], "&"}], "@@@", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"Range", "[", "nD", "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stateP1c", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]M", "[", "#1", "]"}], ",", 
        RowBox[{"\[Phi]0c", "[", "#2", "]"}]}], "}"}], "&"}], "@@@", 
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"Range", "[", "nD", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stateP2", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CurlyPhi]P", "[", "i", "]"}], ",", 
          RowBox[{"\[Chi]", "[", "j", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nc"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stateP2c", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CurlyPhi]M", "[", "i", "]"}], ",", 
          RowBox[{"\[Chi]", "[", "j", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nc"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.965815561113627*^9, 3.9658156042545567`*^9}, {
   3.965815672439578*^9, 3.965815689747334*^9}, 3.965815771474182*^9, {
   3.9658158195048122`*^9, 3.9658158356546993`*^9}, {3.965815922269135*^9, 
   3.965815971819428*^9}, 3.9658160925915127`*^9, 3.9658177039059973`*^9, 
   3.965822035817245*^9, {3.965987425626395*^9, 3.965987425626726*^9}, {
   3.966501131430842*^9, 3.9665011381096907`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"c2663a8d-dbd7-463b-9d4a-a69ee5bf8bc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SM11", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nD", "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]M", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]0c", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]M", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]0c", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]M", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]0c", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]M", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]0c", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.965816014380961*^9, 3.965816035305945*^9}, 
   3.96581614125391*^9, {3.965816415531067*^9, 3.96581648625202*^9}, {
   3.965816534253602*^9, 3.965816568023066*^9}, {3.965816613223777*^9, 
   3.96581661631037*^9}, {3.965816649984733*^9, 3.965816650843482*^9}, {
   3.965816979217909*^9, 3.9658169799802847`*^9}, {3.9658173463818827`*^9, 
   3.9658173510806007`*^9}, {3.965817580045741*^9, 3.965817580089705*^9}, {
   3.965817866575883*^9, 3.965818032668462*^9}, {3.965818257974135*^9, 
   3.9658182624216127`*^9}, {3.965818295423892*^9, 3.965818305519773*^9}, {
   3.9658220117287607`*^9, 3.965822019061825*^9}, 3.965987425627592*^9, {
   3.966501140675033*^9, 3.966501140766974*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"f3100729-5b39-4a23-ac98-07bf699286e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SM12", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ff"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nD", "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ff", "=", 
        RowBox[{"stateP2c", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           SqrtBox["2"]], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ff", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ff", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ff", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.965818281378675*^9, 3.965818445697481*^9}, {
   3.965818500971034*^9, 3.965818501231695*^9}, 3.9658188222293262`*^9, 
   3.965987425628275*^9, {3.9665011491803303`*^9, 3.966501158667246*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"5449eaf6-7630-45ca-a553-cb1ec356f636"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SM21", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ff"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nD", "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ff", "=", 
        RowBox[{"stateP2", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           SqrtBox["2"]], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]M", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0c", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ff", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]M", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0c", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ff", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ff", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.965818505687641*^9, 3.965818548687708*^9}, 
   3.965818825385557*^9, 3.965987425628952*^9, {3.96650116424608*^9, 
   3.966501166565844*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"dcde26bc-6765-40cf-8810-c7ef67245165"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SM22", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ssd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"stateP2", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ssd", "=", 
        RowBox[{"stateP2c", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"VVV", ",", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"ssd", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ssd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
     "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.961557362087435*^9, 3.9615573818082523`*^9}, {
   3.961557429456059*^9, 3.961557466301087*^9}, {3.9615575519532948`*^9, 
   3.961557596061483*^9}, {3.9615621754682007`*^9, 3.961562194233508*^9}, 
   3.961562227897045*^9, {3.961562263421062*^9, 3.961562333385951*^9}, {
   3.9615623664990883`*^9, 3.961562465043407*^9}, {3.961562504430759*^9, 
   3.961562539568851*^9}, {3.9615626332127113`*^9, 3.961562643044835*^9}, {
   3.961562868980578*^9, 3.9615628851829863`*^9}, {3.961562942630371*^9, 
   3.961563028659017*^9}, {3.9615631099213753`*^9, 3.961563112368203*^9}, {
   3.961563175410603*^9, 3.961563186995729*^9}, {3.9615634037106857`*^9, 
   3.9615634764599533`*^9}, {3.961563528568614*^9, 3.961563533278542*^9}, {
   3.9615636335045033`*^9, 3.961563639439384*^9}, {3.961564978831091*^9, 
   3.961564979291746*^9}, {3.961565083924752*^9, 3.9615650980337753`*^9}, {
   3.961565158819345*^9, 3.9615652117825108`*^9}, {3.961565250742722*^9, 
   3.961565346459837*^9}, {3.961565380678731*^9, 3.961565382107504*^9}, {
   3.961565434513001*^9, 3.961565470882923*^9}, {3.961565536758751*^9, 
   3.961565570507143*^9}, {3.961565680424222*^9, 3.961565797230665*^9}, 
   3.961565863837698*^9, 3.961565944261169*^9, {3.9615659963297367`*^9, 
   3.961565998271183*^9}, {3.961566036441738*^9, 3.961566105937653*^9}, {
   3.961566140804175*^9, 3.9615661990433207`*^9}, {3.9615662415871687`*^9, 
   3.961566269553461*^9}, {3.961566379204405*^9, 3.961566383271199*^9}, {
   3.96156641351088*^9, 3.961566460213718*^9}, {3.9615668194916563`*^9, 
   3.9615668622000523`*^9}, {3.9615669565903378`*^9, 3.961566956629999*^9}, {
   3.961570028240814*^9, 3.961570037927545*^9}, {3.961570185959549*^9, 
   3.961570193679772*^9}, {3.9615710844622726`*^9, 3.961571123777259*^9}, {
   3.9615711684341*^9, 3.9615711713845167`*^9}, {3.961571232943623*^9, 
   3.961571233101405*^9}, {3.9615712670345993`*^9, 3.961571345607335*^9}, {
   3.9615715413436327`*^9, 3.961571555357355*^9}, {3.961572651013055*^9, 
   3.961572668856901*^9}, 3.964685269186693*^9, {3.965816052163686*^9, 
   3.965816094573468*^9}, {3.965816152249386*^9, 3.965816153479107*^9}, {
   3.9658185551010303`*^9, 3.965818556632031*^9}, {3.9665011753636847`*^9, 
   3.966501178743615*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"d107637b-6208-4179-852a-d758396cfe29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"state", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"stateP1", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
     RowBox[{"stateP2", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SM", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"SM11", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"SM12", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"SM21", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"SM22", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", ",", "2"}], "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.965818562877129*^9, 3.96581862730676*^9}, {
   3.9658190790754223`*^9, 3.965819083292432*^9}, 3.965820653070793*^9, {
   3.966394897541951*^9, 3.966394898033924*^9}, {3.966501180410284*^9, 
   3.9665011988710938`*^9}, 3.9665012333726673`*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"f3a96f46-0573-491f-a0aa-5fd6865431aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scattering matrix |1, 1/2, 1/2\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.961559711781605*^9, 3.961559716408942*^9}, {
   3.9615663633592*^9, 3.961566376149317*^9}, {3.961570020404307*^9, 
   3.961570020454726*^9}, 3.961571082281945*^9, {3.961571597741703*^9, 
   3.9615715980217457`*^9}, {3.965820805697098*^9, 3.965820809147683*^9}, 
   3.9665008822521353`*^9},ExpressionUUID->"4ab21135-55d4-446e-a7e8-\
00a86a5558b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"state", "[", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "2"}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]P", "[", "i", "]"}], ",", 
            RowBox[{"\[Chi]", "[", "j", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]0c", "[", "i", "]"}], ",", 
            RowBox[{"\[CurlyPhi]P", "[", "j", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"statec", "[", 
     RowBox[{"1", ",", 
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{"1", "/", "2"}]}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]M", "[", "i", "]"}], ",", 
             RowBox[{"\[Chi]", "[", "j", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "nn"}], "}"}]}], "]"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]0", "[", "i", "]"}], ",", 
             RowBox[{"\[CurlyPhi]M", "[", "j", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SM", "[", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "2"}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ssd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"state", "[", 
         RowBox[{"1", ",", 
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ssd", "=", 
        RowBox[{"statec", "[", 
         RowBox[{"1", ",", 
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"VVV", ",", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"ssd", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ssd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
     "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.961557362087435*^9, 3.9615573818082523`*^9}, {
   3.961557429456059*^9, 3.961557466301087*^9}, {3.9615575519532948`*^9, 
   3.961557596061483*^9}, {3.9615621754682007`*^9, 3.961562194233508*^9}, 
   3.961562227897045*^9, {3.961562263421062*^9, 3.961562333385951*^9}, {
   3.9615623664990883`*^9, 3.961562465043407*^9}, {3.961562504430759*^9, 
   3.961562539568851*^9}, {3.9615626332127113`*^9, 3.961562643044835*^9}, {
   3.961562868980578*^9, 3.9615628851829863`*^9}, {3.961562942630371*^9, 
   3.961563028659017*^9}, {3.9615631099213753`*^9, 3.961563112368203*^9}, {
   3.961563175410603*^9, 3.961563186995729*^9}, {3.9615634037106857`*^9, 
   3.9615634764599533`*^9}, {3.961563528568614*^9, 3.961563533278542*^9}, {
   3.9615636335045033`*^9, 3.961563639439384*^9}, {3.961564978831091*^9, 
   3.961564979291746*^9}, {3.961565083924752*^9, 3.9615650980337753`*^9}, {
   3.961565158819345*^9, 3.9615652117825108`*^9}, {3.961565250742722*^9, 
   3.961565346459837*^9}, {3.961565380678731*^9, 3.961565382107504*^9}, {
   3.961565434513001*^9, 3.961565470882923*^9}, {3.961565536758751*^9, 
   3.961565570507143*^9}, {3.961565680424222*^9, 3.961565797230665*^9}, 
   3.961565863837698*^9, 3.961565944261169*^9, {3.9615659963297367`*^9, 
   3.961565998271183*^9}, {3.961566036441738*^9, 3.961566105937653*^9}, {
   3.961566140804175*^9, 3.9615661990433207`*^9}, {3.9615662415871687`*^9, 
   3.961566269553461*^9}, {3.961566379204405*^9, 3.961566383271199*^9}, {
   3.96156641351088*^9, 3.961566460213718*^9}, {3.9615668194916563`*^9, 
   3.9615668622000523`*^9}, {3.9615669565903378`*^9, 3.961566956629999*^9}, {
   3.961570028240814*^9, 3.961570037927545*^9}, {3.961570185959549*^9, 
   3.961570193679772*^9}, {3.9615710844622726`*^9, 3.961571123777259*^9}, {
   3.9615711684341*^9, 3.9615711713845167`*^9}, {3.961571232943623*^9, 
   3.961571233101405*^9}, {3.9615712670345993`*^9, 3.961571345607335*^9}, {
   3.9615715413436327`*^9, 3.961571555357355*^9}, {3.96157160374689*^9, 
   3.961571639166741*^9}, {3.961571705611866*^9, 3.961571732117838*^9}, {
   3.9615726819388323`*^9, 3.961572697529895*^9}, 3.9646852763350763`*^9, {
   3.965820481780695*^9, 3.965820486644322*^9}, {3.965987425629768*^9, 
   3.965987425631405*^9}, {3.966394891507306*^9, 3.966394892335771*^9}, {
   3.9665012445927677`*^9, 3.966501250403076*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"80e09e97-efbe-44b2-829c-c0b21b6ee1de"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scattering matrix |1, 0, 1\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.961559711781605*^9, 3.961559716408942*^9}, {
   3.9615663633592*^9, 3.961566376149317*^9}, {3.961570020404307*^9, 
   3.961570020454726*^9}, 3.961571779944871*^9, {3.965820822884267*^9, 
   3.9658208267628107`*^9}, 
   3.966500883368216*^9},ExpressionUUID->"50849b2f-fd45-48d4-9366-\
5e527df879b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"state", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]P", "[", "i", "]"}], ",", 
          RowBox[{"\[Phi]0c", "[", "j", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "nD"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"statec", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]M", "[", "i", "]"}], ",", 
           RowBox[{"\[Phi]0", "[", "j", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nD"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "nD"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SM", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ssd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"state", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ssd", "=", 
        RowBox[{"statec", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"VVV", ",", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"ssd", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ssd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
     "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.961557362087435*^9, 3.9615573818082523`*^9}, {
   3.961557429456059*^9, 3.961557466301087*^9}, {3.9615575519532948`*^9, 
   3.961557596061483*^9}, {3.9615621754682007`*^9, 3.961562194233508*^9}, 
   3.961562227897045*^9, {3.961562263421062*^9, 3.961562333385951*^9}, {
   3.9615623664990883`*^9, 3.961562465043407*^9}, {3.961562504430759*^9, 
   3.961562539568851*^9}, {3.9615626332127113`*^9, 3.961562643044835*^9}, {
   3.961562868980578*^9, 3.9615628851829863`*^9}, {3.961562942630371*^9, 
   3.961563028659017*^9}, {3.9615631099213753`*^9, 3.961563112368203*^9}, {
   3.961563175410603*^9, 3.961563186995729*^9}, {3.9615634037106857`*^9, 
   3.9615634764599533`*^9}, {3.961563528568614*^9, 3.961563533278542*^9}, {
   3.9615636335045033`*^9, 3.961563639439384*^9}, {3.961564978831091*^9, 
   3.961564979291746*^9}, {3.961565083924752*^9, 3.9615650980337753`*^9}, {
   3.961565158819345*^9, 3.9615652117825108`*^9}, {3.961565250742722*^9, 
   3.961565346459837*^9}, {3.961565380678731*^9, 3.961565382107504*^9}, {
   3.961565434513001*^9, 3.961565470882923*^9}, {3.961565536758751*^9, 
   3.961565570507143*^9}, {3.961565680424222*^9, 3.961565797230665*^9}, 
   3.961565863837698*^9, 3.961565944261169*^9, {3.9615659963297367`*^9, 
   3.961565998271183*^9}, {3.961566036441738*^9, 3.961566105937653*^9}, {
   3.961566140804175*^9, 3.9615661990433207`*^9}, {3.9615662415871687`*^9, 
   3.961566269553461*^9}, {3.961566379204405*^9, 3.961566383271199*^9}, {
   3.96156641351088*^9, 3.961566460213718*^9}, {3.9615668194916563`*^9, 
   3.9615668622000523`*^9}, {3.9615669565903378`*^9, 3.961566956629999*^9}, {
   3.961570028240814*^9, 3.961570037927545*^9}, {3.961570185959549*^9, 
   3.961570193679772*^9}, {3.961571782619422*^9, 3.961571809245515*^9}, {
   3.961572709635332*^9, 3.961572721114155*^9}, 3.9646852816929083`*^9, {
   3.9659874256320887`*^9, 3.9659874256333714`*^9}, {3.9663948835457983`*^9, 
   3.9663948843078947`*^9}, {3.966501260189411*^9, 3.9665012676695967`*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"ed835bd6-c056-45f8-9edf-cab5198e58bf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scattering matrix |0, 0, 0\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.961559711781605*^9, 3.961559716408942*^9}, {
   3.9615663633592*^9, 3.961566376149317*^9}, {3.961570020404307*^9, 
   3.961570020454726*^9}, 3.961571082281945*^9, {3.965815043741815*^9, 
   3.9658150470128*^9}, {3.965821021177966*^9, 3.965821022692265*^9}, 
   3.966500884718802*^9},ExpressionUUID->"3446b21b-5e87-48ee-9f30-\
f92a7061c0b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stateP1", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalPhi]P", "[", "#1", "]"}], ",", 
       RowBox[{"\[CapitalPhi]M", "[", "#2", "]"}]}], "}"}], "&"}], "@@@", 
    RowBox[{"Tuples", "[", 
     RowBox[{
      RowBox[{"Range", "[", "nD", "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stateP1c", "[", 
     RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalPhi]M", "[", "#1", "]"}], ",", 
        RowBox[{"\[CapitalPhi]P", "[", "#2", "]"}]}], "}"}], "&"}], "@@@", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"Range", "[", "nD", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stateP2", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[CurlyPhi]P", "[", "i", "]"}], ",", 
            RowBox[{"\[CurlyPhi]M", "[", "j", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nc"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Chi]", "[", "i", "]"}], ",", 
            RowBox[{"\[Chi]", "[", "j", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "nn"}], "}"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stateP2c", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[CurlyPhi]M", "[", "i", "]"}], ",", 
            RowBox[{"\[CurlyPhi]P", "[", "j", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nc"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "nc"}], "}"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Chi]", "[", "i", "]"}], ",", 
            RowBox[{"\[Chi]", "[", "j", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nn"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "nn"}], "}"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.965815561113627*^9, 3.9658156042545567`*^9}, {
   3.965815672439578*^9, 3.965815689747334*^9}, 3.965815771474182*^9, {
   3.9658158195048122`*^9, 3.9658158356546993`*^9}, {3.965815922269135*^9, 
   3.965815971819428*^9}, 3.9658160925915127`*^9, 3.9658177039059973`*^9, {
   3.965821038055778*^9, 3.965821047985186*^9}, {3.9658211243552847`*^9, 
   3.965821140235324*^9}, {3.965821241484283*^9, 3.965821271086781*^9}, {
   3.965821355979735*^9, 3.965821372960837*^9}, {3.965821609981028*^9, 
   3.96582161201727*^9}, {3.965822120315927*^9, 3.9658221273054132`*^9}, {
   3.965824745865822*^9, 3.965824760264179*^9}, {3.9659874256340933`*^9, 
   3.965987425634492*^9}, {3.9665012739449463`*^9, 3.966501279328279*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"f3a32590-3c06-4712-a9e0-63eff6ba075b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SM11", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nD", "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]M", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]M", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]P", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]M", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]0c", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]0", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]0", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0c", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]M", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]P", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]0", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"\[Phi]0c", "[", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"\[Phi]0c", "[", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"\[Phi]0", "[", 
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.965816014380961*^9, 3.965816035305945*^9}, 
   3.96581614125391*^9, {3.965816415531067*^9, 3.96581648625202*^9}, {
   3.965816534253602*^9, 3.965816568023066*^9}, {3.965816613223777*^9, 
   3.96581661631037*^9}, {3.965816649984733*^9, 3.965816650843482*^9}, {
   3.965816979217909*^9, 3.9658169799802847`*^9}, {3.9658173463818827`*^9, 
   3.9658173510806007`*^9}, {3.965817580045741*^9, 3.965817580089705*^9}, {
   3.965817866575883*^9, 3.965818032668462*^9}, {3.965818257974135*^9, 
   3.9658182624216127`*^9}, {3.965818295423892*^9, 3.965818305519773*^9}, {
   3.9658212877500267`*^9, 3.9658213125833817`*^9}, {3.9658214434752827`*^9, 
   3.965821528985964*^9}, 3.965821578333256*^9, {3.965821758635461*^9, 
   3.965821762308528*^9}, {3.965822136523842*^9, 3.9658221380055532`*^9}, 
   3.965822991929824*^9, 3.965987425635343*^9, 3.96650128311125*^9},
 CellLabel->
  "In[174]:=",ExpressionUUID->"8c5fbb83-0721-45f2-900e-e410b10b576c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SM12", "[", 
     RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "ss", ",", "ff"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ss", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", "nD", "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ff", "=", 
         RowBox[{"stateP2c", "[", 
          RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ff", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ff", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             FractionBox["1", 
              SqrtBox["2"]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]M", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                   ",", 
                   RowBox[{"ff", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ff", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
               "\[IndentingNewLine]", "+", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]0", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]0c", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                   ",", 
                   RowBox[{"ff", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ff", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ")"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             FractionBox["1", 
              RowBox[{
               SqrtBox["2"], 
               SqrtBox["2"]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]M", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                   ",", 
                   RowBox[{"ff", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ff", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
               "\[IndentingNewLine]", "+", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]0", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]0c", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                   ",", 
                   RowBox[{"ff", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ff", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "ff", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.965818281378675*^9, 3.965818445697481*^9}, {
   3.965818500971034*^9, 3.965818501231695*^9}, 3.9658188222293262`*^9, 
   3.965821589447052*^9, {3.965822064581018*^9, 3.965822106839312*^9}, {
   3.965822140943121*^9, 3.965822144872123*^9}, {3.965822228959826*^9, 
   3.9658222312755947`*^9}, {3.965822280718997*^9, 3.965822377320696*^9}, 
   3.965822989143238*^9, {3.965824506349942*^9, 3.9658245251714563`*^9}, 
   3.965824897561252*^9, 3.965987425636252*^9, {3.966501286730217*^9, 
   3.966501287650687*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"6c63508f-1518-4a24-ac10-4846fe4e4fe5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SM21", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ff"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nD", "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ff", "=", 
        RowBox[{"stateP2c", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ff", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
            RowBox[{"ff", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["2"]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]M", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"ff", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
              "\[IndentingNewLine]", "+", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]0c", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]0", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"ff", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              SqrtBox["2"], 
              SqrtBox["2"]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]M", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]P", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"ff", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
              "\[IndentingNewLine]", "+", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"VVV", ",", 
                    RowBox[{"\[Phi]0c", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"\[Phi]0", "[", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"ff", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ff", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ")"}]}]}],
           "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ff", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.965818505687641*^9, 3.965818548687708*^9}, 
   3.965818825385557*^9, 3.965821590564233*^9, {3.965822429535131*^9, 
   3.965822462854961*^9}, {3.965822976879035*^9, 3.965822995415415*^9}, 
   3.965987425637252*^9, {3.966501293201034*^9, 3.966501295280719*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"47c55e24-c5e0-49d5-93b8-a8d52a0c507d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SM22", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "ss", ",", "ssd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"stateP2", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ssd", "=", 
        RowBox[{"stateP2c", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"VVV", ",", 
                   RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ss", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"ssd", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["2"]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["2"]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], "===", 
             RowBox[{"ssd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"VVV", ",", 
                    RowBox[{"ss", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ss", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"ssd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"ssd", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ssd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ss", "]"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
     "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.961557362087435*^9, 3.9615573818082523`*^9}, {
   3.961557429456059*^9, 3.961557466301087*^9}, {3.9615575519532948`*^9, 
   3.961557596061483*^9}, {3.9615621754682007`*^9, 3.961562194233508*^9}, 
   3.961562227897045*^9, {3.961562263421062*^9, 3.961562333385951*^9}, {
   3.9615623664990883`*^9, 3.961562465043407*^9}, {3.961562504430759*^9, 
   3.961562539568851*^9}, {3.9615626332127113`*^9, 3.961562643044835*^9}, {
   3.961562868980578*^9, 3.9615628851829863`*^9}, {3.961562942630371*^9, 
   3.961563028659017*^9}, {3.9615631099213753`*^9, 3.961563112368203*^9}, {
   3.961563175410603*^9, 3.961563186995729*^9}, {3.9615634037106857`*^9, 
   3.9615634764599533`*^9}, {3.961563528568614*^9, 3.961563533278542*^9}, {
   3.9615636335045033`*^9, 3.961563639439384*^9}, {3.961564978831091*^9, 
   3.961564979291746*^9}, {3.961565083924752*^9, 3.9615650980337753`*^9}, {
   3.961565158819345*^9, 3.9615652117825108`*^9}, {3.961565250742722*^9, 
   3.961565346459837*^9}, {3.961565380678731*^9, 3.961565382107504*^9}, {
   3.961565434513001*^9, 3.961565470882923*^9}, {3.961565536758751*^9, 
   3.961565570507143*^9}, {3.961565680424222*^9, 3.961565797230665*^9}, 
   3.961565863837698*^9, 3.961565944261169*^9, {3.9615659963297367`*^9, 
   3.961565998271183*^9}, {3.961566036441738*^9, 3.961566105937653*^9}, {
   3.961566140804175*^9, 3.9615661990433207`*^9}, {3.9615662415871687`*^9, 
   3.961566269553461*^9}, {3.961566379204405*^9, 3.961566383271199*^9}, {
   3.96156641351088*^9, 3.961566460213718*^9}, {3.9615668194916563`*^9, 
   3.9615668622000523`*^9}, {3.9615669565903378`*^9, 3.961566956629999*^9}, {
   3.961570028240814*^9, 3.961570037927545*^9}, {3.961570185959549*^9, 
   3.961570193679772*^9}, {3.9615710844622726`*^9, 3.961571123777259*^9}, {
   3.9615711684341*^9, 3.9615711713845167`*^9}, {3.961571232943623*^9, 
   3.961571233101405*^9}, {3.9615712670345993`*^9, 3.961571345607335*^9}, {
   3.9615715413436327`*^9, 3.961571555357355*^9}, {3.961572651013055*^9, 
   3.961572668856901*^9}, 3.964685269186693*^9, {3.965816052163686*^9, 
   3.965816094573468*^9}, {3.965816152249386*^9, 3.965816153479107*^9}, {
   3.9658185551010303`*^9, 3.965818556632031*^9}, {3.965822565547114*^9, 
   3.965822572525877*^9}, {3.965822942760539*^9, 3.965823006247512*^9}, {
   3.966501345496326*^9, 3.966501347380013*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"594a91aa-5b16-4725-a810-ee29d72236cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"state", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"stateP1", "[", 
      RowBox[{"0", ",", "0", ",", "0"}], "]"}], ",", 
     RowBox[{"stateP2", "[", 
      RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SM", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"SM11", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}], ",", 
        RowBox[{"SM12", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"SM21", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}], ",", 
        RowBox[{"SM22", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", ",", "2"}], "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.965818562877129*^9, 3.96581862730676*^9}, {
   3.9658190790754223`*^9, 3.965819083292432*^9}, 3.965820653070793*^9, {
   3.96582302279837*^9, 3.9658230791374474`*^9}, {3.965990399298481*^9, 
   3.965990400667552*^9}, {3.966394875796476*^9, 3.9663948763894463`*^9}, {
   3.9665013541515102`*^9, 3.966501363088304*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"f5c00e9a-fbe8-45fe-b919-f36c7fc7a7ba"]
}, Closed]],

Cell[CellGroupData[{

Cell["Block-diagonalization module", "Subsubsection",
 CellChangeTimes->{{3.9625284148641043`*^9, 3.962528416404791*^9}, {
  3.962635355525889*^9, 3.9626353573723297`*^9}, {3.9626355704801292`*^9, 
  3.96263557158039*^9}, {3.966500766903388*^9, 
  3.96650077487938*^9}},ExpressionUUID->"8d773dba-d959-4de6-bfdd-\
9f60d7c0d8cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "BlockDiagonalize", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockDiagonalize", "[", 
   RowBox[{"matrix_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "nonzeroQ", ",", "adjacency", ",", "g", ",", "components", ",",
       "ordering", ",", "P", ",", "permutedMatrix"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "matrix", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nonzeroQ", "[", "x_", "]"}], ":=", 
      RowBox[{"!", 
       RowBox[{"TrueQ", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{"x", "===", "0"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Build", " ", "adjacency", " ", "matrix", " ", "from", " ", "nonzero", 
       " ", "pattern"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"adjacency", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nonzeroQ", "[", 
           RowBox[{"matrix", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", "1", ",", 
          "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Create", " ", "undirected", " ", "graph", " ", "of", " ", "nonzero", 
       " ", "connections"}], "*)"}], 
     RowBox[{"g", "=", 
      RowBox[{"Graph", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", 
        RowBox[{"UndirectedEdge", "@@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "n"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
             "1"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"adjacency", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "==", "1"}], 
            "&"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Find", " ", "connected", " ", "components", " ", "and", " ", "use", 
       " ", "as", " ", "permutation", " ", "blocks"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"components", "=", 
      RowBox[{"ConnectedComponents", "[", "g", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ordering", "=", 
      RowBox[{"Flatten", "[", "components", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Permutation", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "n", "]"}], "[", 
       RowBox[{"[", "ordering", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Apply", " ", "similarity", " ", "transformation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"permutedMatrix", "=", 
      RowBox[{"P", ".", "matrix", ".", 
       RowBox[{"Transpose", "[", "P", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Return", " ", "block"}], "-", 
       RowBox[{
       "diagonalized", " ", "matrix", " ", "and", " ", "the", " ", 
        "permutation", " ", "used"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<BDMatrix\>\"", "->", "permutedMatrix"}], ",", 
       RowBox[{"\"\<Permutation\>\"", "->", "ordering"}], ",", 
       RowBox[{"\"\<PMatrix\>\"", "->", "P"}], ",", 
       RowBox[{"\"\<Components\>\"", "->", "components"}]}], "|>"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.963133939653159*^9, 3.9631339407039013`*^9}, {
   3.963134292532516*^9, 3.9631343153728437`*^9}, 3.963134575340876*^9, 
   3.9631349288207407`*^9, {3.9665008460802317`*^9, 3.966500853253686*^9}, {
   3.9683285047321568`*^9, 3.9683285117017727`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"5cf50b07-db40-4f3d-85a7-d771941b33b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualization module", "Subsubsection",
 CellChangeTimes->{{3.9631332302704897`*^9, 3.9631332400849733`*^9}, {
  3.966500759549047*^9, 
  3.966500763074945*^9}},ExpressionUUID->"01fbd97c-b15f-42fa-b5a8-\
ffe64f5d314a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "visual", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"visual", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[CapitalPhi]", ",", "a"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[CapitalPhi]", ",", "a", ",", "\"\<\[Dagger]\>\""}], "]"}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"\[CurlyPhi]P", "[", "a_", "]"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[CurlyPhi]", ",", "a", ",", "\"\<-\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", "a_", "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Chi]", ",", "a"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]P", "[", "a_", "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[CapitalPhi]", ",", "a"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]M", "[", "a_", "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[CapitalPhi]", ",", "a", ",", "\"\<\[Dagger]\>\""}], "]"}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]P", "[", "a_", "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Phi]", ",", "a", ",", "\"\<+\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]M", "[", "a_", "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Phi]", ",", "a", ",", "\"\<-\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]0", "[", "a_", "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Phi]", ",", "a", ",", "\"\<0\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]0c", "[", "a_", "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Phi]", ",", "a", ",", "\"\<0*\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CurlyPhi]P", "[", "a_", "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[CurlyPhi]", ",", "a", ",", "\"\<+\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CurlyPhi]M", "[", "a_", "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[CurlyPhi]", ",", "a", ",", "\"\<-\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"0", "/;", 
       RowBox[{"a", "===", "b"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"0", "/;", 
       RowBox[{"a", "===", "b"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Lambda]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Beta]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Gamma]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Delta]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Zeta]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Zeta]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Kappa]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Lambda]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}], ",", "\"\<*\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}], ",", "\"\<*\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Beta]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Beta]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}], ",", "\"\<*\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Gamma]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}], ",", "\"\<*\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Delta]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Delta]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}], ",", "\"\<*\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Zeta]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Zeta]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}], ",", "\"\<*\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]c", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
      RowBox[{"Subsuperscript", "[", 
       RowBox[{"\[Kappa]", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\"\<,\>\"", ",", "c", ",", "d"}], 
          "}"}], "]"}], ",", "\"\<*\>\""}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.963132204708715*^9, 3.96313226390905*^9}, {
   3.964689508644096*^9, 3.964689516523547*^9}, {3.965461955942253*^9, 
   3.965461960134739*^9}, {3.9654619988017483`*^9, 3.965462092754087*^9}, {
   3.9654621238851147`*^9, 3.965462125299652*^9}, {3.9654622175570087`*^9, 
   3.965462224820807*^9}, {3.965823191728711*^9, 3.965823204619059*^9}, {
   3.9658232653723373`*^9, 3.965823304615753*^9}, 3.965823429501977*^9, {
   3.9664208359969397`*^9, 3.966420848122222*^9}, {3.966420946974675*^9, 
   3.966421072441125*^9}, {3.9664211322437277`*^9, 3.966421209251128*^9}, {
   3.966421397700042*^9, 3.966421453439402*^9}, 3.966421804199993*^9, {
   3.966423329233163*^9, 3.966423332621839*^9}, {3.966425398253413*^9, 
   3.9664254336614532`*^9}, {3.966425478476302*^9, 3.9664254889691877`*^9}, {
   3.9665008377440434`*^9, 3.966500842048127*^9}, {3.9665023659800377`*^9, 
   3.9665023810042057`*^9}, {3.966502863123076*^9, 3.966502892661593*^9}, {
   3.966503019425555*^9, 3.966503049173419*^9}, {3.9665030836144753`*^9, 
   3.966503125802203*^9}, 3.966507675009219*^9, {3.96650777130682*^9, 
   3.9665078093381042`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"45ec185a-2707-4a44-8b47-f39dd6ae0100"]
}, Closed]],

Cell[CellGroupData[{

Cell["User Functions", "Subsubsection",
 CellChangeTimes->{{3.96650079666009*^9, 3.966500800056566*^9}, {
  3.9683285233939857`*^9, 
  3.968328525084*^9}},ExpressionUUID->"de581518-5954-49c5-8cdd-a25535bc65e4"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "Potential4", ",", "Basis", ",", "ScatteringMatrix", ",", "EigenList"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9665031656983833`*^9, 3.9665031770903797`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"fa48e254-f1db-4618-bc55-2771b681c8f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Potential4", "=", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"VafterSym", "//.", "conditionsHC"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "_\[Lambda]", ",", "_\[Alpha]", ",", "_\[Beta]", ",", "_\[Gamma]", ",",
         "_\[Delta]", ",", "_\[Zeta]", ",", "_\[Kappa]", ",", "_\[Lambda]c", 
        ",", "_\[Alpha]c", ",", "_\[Beta]c", ",", "_\[Gamma]c", ",", 
        "_\[Delta]c", ",", "_\[Zeta]c", ",", "_\[Kappa]c"}], "}"}]}], "]"}], "/.",
     "visual"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.966500805704853*^9, 3.966500819089843*^9}, {
   3.966500911904581*^9, 3.9665010572446117`*^9}, {3.966501429046041*^9, 
   3.9665014323930597`*^9}, {3.966501490386736*^9, 3.966501496768839*^9}, {
   3.966502283592291*^9, 3.966502328948105*^9}, 3.966502398364148*^9, {
   3.966502452349647*^9, 3.966502453685892*^9}, {3.966502532046071*^9, 
   3.966502558872819*^9}, 3.9665027606419277`*^9, {3.9665027906421127`*^9, 
   3.966502792195653*^9}, {3.9665031494627028`*^9, 3.96650316124743*^9}, 
   3.966503221951277*^9, {3.966503429033095*^9, 3.966503464736855*^9}, {
   3.96650398639187*^9, 3.966504064374876*^9}, {3.966504123545081*^9, 
   3.966504152551374*^9}, {3.966505362809835*^9, 3.966505364130082*^9}, {
   3.966505418043995*^9, 3.966505425244569*^9}, {3.966505670771348*^9, 
   3.966505673008486*^9}, {3.9672780364395647`*^9, 3.967278176080063*^9}, {
   3.967278229064143*^9, 3.9672782816174803`*^9}, {3.967278312231187*^9, 
   3.967278406913987*^9}, {3.967278501991969*^9, 3.967278609488882*^9}, {
   3.9683230055113993`*^9, 3.968323014950783*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"03247b01-51ff-4ed9-b6e6-63e41de098c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Basis", "[", 
   RowBox[{"Q_", ",", "Y_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "MMM", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MMM", "=", 
      RowBox[{
       RowBox[{"BlockDiagonalize", "[", 
        RowBox[{"SM", "[", 
         RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "]"}], "[", 
       "\"\<PMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"MMM", "//", 
        RowBox[{
         RowBox[{"MatrixQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"True", "&"}]}], "]"}], "&"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MMM", ".", 
              RowBox[{"state", "[", 
               RowBox[{"Q", ",", "Y", ",", "T"}], "]"}]}], "/.", "visual"}], 
            ")"}]}], "//", "Flatten"}], "}"}], "//", "MatrixForm"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\< The state |Q, Y, T\[RightAngleBracket] you are trying to \
access does not exist. \\n Try a different combination of |Q, Y, T\
\[RightAngleBracket]\>\"", ",", "Red", ",", "Bold", ",", " ", 
          RowBox[{"FontSize", "->", "14"}]}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.966500805704853*^9, 3.966500819089843*^9}, {
   3.966500911904581*^9, 3.9665010572446117`*^9}, {3.966501429046041*^9, 
   3.9665014323930597`*^9}, {3.966501490386736*^9, 3.966501496768839*^9}, {
   3.966502283592291*^9, 3.966502328948105*^9}, 3.966502398364148*^9, {
   3.966502452349647*^9, 3.966502453685892*^9}, {3.966502532046071*^9, 
   3.966502558872819*^9}, 3.9665027606419277`*^9, {3.9665027906421127`*^9, 
   3.966502792195653*^9}, {3.9665031494627028`*^9, 3.96650316124743*^9}, 
   3.966503221951277*^9, {3.966503429033095*^9, 3.966503464736855*^9}, {
   3.96650398639187*^9, 3.966504064374876*^9}, {3.966504123545081*^9, 
   3.966504152551374*^9}, {3.966505362809835*^9, 3.966505364130082*^9}, {
   3.966505418043995*^9, 3.966505425244569*^9}, {3.966505670771348*^9, 
   3.966505673008486*^9}, {3.9672780364395647`*^9, 3.967278176080063*^9}, {
   3.967278229064143*^9, 3.9672782816174803`*^9}, {3.967278312231187*^9, 
   3.967278406913987*^9}, {3.967278501991969*^9, 3.967278609488882*^9}, {
   3.9683230055113993`*^9, 3.968323014950783*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"e72abbc0-6e62-40f0-acd3-4b0e30d43a07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScatteringMatrix", "[", 
   RowBox[{"Q_", ",", "Y_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "MMM", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MMM", "=", 
      RowBox[{
       RowBox[{"BlockDiagonalize", "[", 
        RowBox[{"SM", "[", 
         RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "]"}], "[", 
       "\"\<PMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"MMM", "//", 
        RowBox[{
         RowBox[{"MatrixQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"True", "&"}]}], "]"}], "&"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BlockDiagonalize", "[", 
           RowBox[{"SM", "[", 
            RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "]"}], "[", 
          "\"\<BDMatrix\>\"", "]"}], "/.", "visual"}], "//", "MatrixForm"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\< The state |Q, Y, T\[RightAngleBracket] you are trying to \
access does not exist. \\n Try a different combination of |Q, Y, T\
\[RightAngleBracket]\>\"", ",", "Red", ",", "Bold", ",", " ", 
          RowBox[{"FontSize", "->", "14"}]}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.966500805704853*^9, 3.966500819089843*^9}, {
   3.966500911904581*^9, 3.9665010572446117`*^9}, {3.966501429046041*^9, 
   3.9665014323930597`*^9}, {3.966501490386736*^9, 3.966501496768839*^9}, {
   3.966502283592291*^9, 3.966502328948105*^9}, 3.966502398364148*^9, {
   3.966502452349647*^9, 3.966502453685892*^9}, {3.966502532046071*^9, 
   3.966502558872819*^9}, 3.9665027606419277`*^9, {3.9665027906421127`*^9, 
   3.966502792195653*^9}, {3.9665031494627028`*^9, 3.96650316124743*^9}, 
   3.966503221951277*^9, {3.966503429033095*^9, 3.966503464736855*^9}, {
   3.96650398639187*^9, 3.966504064374876*^9}, {3.966504123545081*^9, 
   3.966504152551374*^9}, {3.966505362809835*^9, 3.966505364130082*^9}, {
   3.966505418043995*^9, 3.966505425244569*^9}, {3.966505670771348*^9, 
   3.966505673008486*^9}, {3.9672780364395647`*^9, 3.967278176080063*^9}, {
   3.967278229064143*^9, 3.9672782816174803`*^9}, {3.967278312231187*^9, 
   3.967278406913987*^9}, {3.967278501991969*^9, 3.967278609488882*^9}, {
   3.9683230055113993`*^9, 3.968323010212414*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"8a19379f-a06f-4eff-baec-2be14356133e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenList", "[", 
   RowBox[{"Q_", ",", "Y_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "MMM", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MMM", "=", 
      RowBox[{
       RowBox[{"BlockDiagonalize", "[", 
        RowBox[{"SM", "[", 
         RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "]"}], "[", 
       "\"\<PMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"MMM", "//", 
        RowBox[{
         RowBox[{"MatrixQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"True", "&"}]}], "]"}], "&"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Column", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"BlockDiagonalize", "[", 
             RowBox[{"SM", "[", 
              RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "]"}], "[", 
            "\"\<BDMatrix\>\"", "]"}], "/.", "visual"}], "//", 
          "Eigenvalues"}], " ", ",", 
         RowBox[{"Spacings", "->", "2"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\< The state |Q, Y, T\[RightAngleBracket] you are trying to \
access does not exist. \\n Try a different combination of |Q, Y, T\
\[RightAngleBracket]\>\"", ",", "Red", ",", "Bold", ",", " ", 
          RowBox[{"FontSize", "->", "14"}]}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.966500805704853*^9, 3.966500819089843*^9}, {
   3.966500911904581*^9, 3.9665010572446117`*^9}, {3.966501429046041*^9, 
   3.9665014323930597`*^9}, {3.966501490386736*^9, 3.966501496768839*^9}, {
   3.966502283592291*^9, 3.966502328948105*^9}, 3.966502398364148*^9, {
   3.966502452349647*^9, 3.966502453685892*^9}, {3.966502532046071*^9, 
   3.966502558872819*^9}, 3.9665027606419277`*^9, {3.9665027906421127`*^9, 
   3.966502792195653*^9}, {3.9665031494627028`*^9, 3.96650316124743*^9}, 
   3.966503221951277*^9, {3.966503429033095*^9, 3.966503464736855*^9}, {
   3.96650398639187*^9, 3.966504064374876*^9}, {3.966504123545081*^9, 
   3.966504152551374*^9}, {3.966505362809835*^9, 3.966505364130082*^9}, {
   3.966505418043995*^9, 3.966505425244569*^9}, {3.966505670771348*^9, 
   3.966505673008486*^9}, {3.9672780364395647`*^9, 3.967278176080063*^9}, {
   3.967278229064143*^9, 3.9672782816174803`*^9}, {3.967278312231187*^9, 
   3.967278406913987*^9}, {3.967278501991969*^9, 3.967278609488882*^9}, 
   3.9683230055113993`*^9},
 CellLabel->
  "In[188]:=",ExpressionUUID->"b096b75a-6288-4138-bd88-2c19ba5ecc12"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Step 3) Visualize and analyze output", "Section",
 CellChangeTimes->{{3.966501513012967*^9, 3.966501514324586*^9}, {
   3.9665016090309057`*^9, 3.96650164307469*^9}, 3.966501700609416*^9, {
   3.966536931323971*^9, 3.966536931964755*^9}, {3.967266105522066*^9, 
   3.967266106049375*^9}},ExpressionUUID->"a51a7701-85df-4352-babe-\
521d55b1c58e"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Visualize the quartic part of the most general scalar \
potential", "Subsubsection"]], "Subsubsection",
 CellChangeTimes->{{3.966501539519555*^9, 3.96650155428892*^9}, {
   3.9665017070209627`*^9, 3.966501708820437*^9}, {3.966501959525898*^9, 
   3.966501962038485*^9}, 3.966502485357431*^9, {3.966503901834011*^9, 
   3.966503907931858*^9}},ExpressionUUID->"14ac4c48-1f03-4b82-a20f-\
5b5d6b138690"],

Cell[BoxData[
 RowBox[{"Potential4", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.966513231965173*^9, 3.966513233837454*^9}, 
   3.9665390688790216`*^9, {3.967278665476747*^9, 3.967278677752994*^9}, {
   3.9682317974220533`*^9, 3.968231799564766*^9}, 3.9683226141800003`*^9, {
   3.968324802697571*^9, 3.9683248066316977`*^9}, {3.968325019676659*^9, 
   3.968325025947771*^9}, {3.968325285345345*^9, 3.96832530945441*^9}, {
   3.968326605707247*^9, 3.968326619784608*^9}, {3.968326873816333*^9, 
   3.968326874556348*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"afa56673-74b8-4b86-9cbe-6e512ca3d288"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Visualize scattering matrices", "Subsubsection"]], \
"Subsubsection",
 CellChangeTimes->{{3.966502492194278*^9, 
  3.966502502361897*^9}},ExpressionUUID->"2c922450-1896-467a-b006-\
0753d1aeb550"],

Cell[TextData[{
 "Chose the state |Q, Y, T\[RightAngleBracket] for which you want the \
block-diagonalized scattering matrix and corresponding basis of states.\n\
Remember that the possible states are |2, 2, 0\[RightAngleBracket], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "2"}], ",", " ", 
    FractionBox["3", "2"], ",", " ", 
    FractionBox["1", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dadef45c-9783-4c29-8199-e2182dab0b19"],
 "\[RightAngleBracket] ,   |2, 1, 1\[RightAngleBracket],   |1, 1, 0\
\[RightAngleBracket], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "1"}], ",", " ", 
    FractionBox["1", "2"], ",", " ", 
    FractionBox["1", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d244b3a8-2961-4703-b201-9c0f59f0ec2f"],
 "\[RightAngleBracket],   |1, 0, 1\[RightAngleBracket],   and  |0, 0, 0\
\[RightAngleBracket]."
}], "Text",
 CellChangeTimes->{{3.966501754550037*^9, 3.9665018100553637`*^9}, {
  3.966503498252801*^9, 3.966503648520986*^9}, {3.9665052918411713`*^9, 
  3.966505299242762*^9}},ExpressionUUID->"dfa925ad-2aa4-4bc3-9f90-\
56e2eba72f1a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Basis", "[", 
  RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ScatteringMatrix", "[", 
  RowBox[{"Q", ",", "Y", ",", "T"}], "]"}]}], "Input",
 CellChangeTimes->{{3.966501816015292*^9, 3.966501850082918*^9}, 
   3.9665028167181273`*^9, {3.9665029629858923`*^9, 3.96650296999494*^9}, {
   3.96650313223349*^9, 3.966503136316504*^9}, {3.966503243962069*^9, 
   3.966503252912738*^9}, 3.966503449411735*^9, {3.966503481681501*^9, 
   3.966503482440545*^9}, {3.966503924362047*^9, 3.966503938170373*^9}, {
   3.96650561488721*^9, 3.966505680233489*^9}, {3.966507614428784*^9, 
   3.966507638376877*^9}, {3.966507966900894*^9, 3.966507967390584*^9}, {
   3.966510017878189*^9, 3.966510020640209*^9}, {3.9665102848267403`*^9, 
   3.9665102853497458`*^9}, {3.966510337324706*^9, 3.9665103758754063`*^9}, {
   3.9665389926575823`*^9, 3.9665390197612057`*^9}, {3.967267929148366*^9, 
   3.967267930818915*^9}, {3.96727843588306*^9, 3.967278452786825*^9}, {
   3.967278638036605*^9, 3.967278642146305*^9}, {3.968130454922317*^9, 
   3.9681305080580273`*^9}, {3.968130539898546*^9, 3.9681305428228807`*^9}, {
   3.96830486098593*^9, 3.96830486456736*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"8a7564df-1b39-4171-8fff-d8d51acd44f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvalues", "Subsubsection",
 CellChangeTimes->{{3.966502145909915*^9, 
  3.966502147584277*^9}},ExpressionUUID->"d88f10f1-8d18-4efe-9d57-\
4a9dbc7de56d"],

Cell[TextData[{
 "Chose the state |Q, Y, T\[RightAngleBracket] for which you want the \
eigenvalues of the scattering matrix.\nRemember that the possible states are \
|2, 2, 0\[RightAngleBracket], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "2"}], ",", " ", 
    FractionBox["3", "2"], ",", " ", 
    FractionBox["1", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6b13c4bf-745b-4c44-8257-c77a1fdb6bd9"],
 "\[RightAngleBracket] ,   |2, 1, 1\[RightAngleBracket],   |1, 1, 0\
\[RightAngleBracket], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "1"}], ",", " ", 
    FractionBox["1", "2"], ",", " ", 
    FractionBox["1", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e9a218ea-d764-44ff-bcfe-b36f4f3de1cf"],
 "\[RightAngleBracket],   |1, 0, 1\[RightAngleBracket],   and  |0, 0, 0\
\[RightAngleBracket]."
}], "Text",
 CellChangeTimes->{{3.966511867103222*^9, 
  3.96651188000252*^9}},ExpressionUUID->"e43662bf-9b24-40e7-b5e7-\
8b3df20c7259"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"EigenList", "[", 
  RowBox[{"Q", ",", "Y", ",", "T"}], "]"}]}], "Input",
 CellChangeTimes->{{3.966502232233498*^9, 3.966502252445014*^9}, {
   3.966502514730175*^9, 3.966502521026041*^9}, {3.966502676375588*^9, 
   3.9665026896341333`*^9}, 3.966502814666935*^9, 3.966503182965526*^9, {
   3.966507864078595*^9, 3.966507864600009*^9}, {3.966510023185102*^9, 
   3.966510024298203*^9}, {3.966510355487445*^9, 3.96651035611659*^9}, {
   3.966511727382248*^9, 3.9665117312157288`*^9}, {3.9665390532380533`*^9, 
   3.966539054647736*^9}, {3.967278459125504*^9, 3.967278459166394*^9}, {
   3.967278634181896*^9, 3.967278634225583*^9}, {3.968130515051303*^9, 
   3.968130535575983*^9}, {3.968130578418704*^9, 3.968130580096835*^9}, {
   3.9681314135226793`*^9, 3.968131417124797*^9}, 3.968304874890925*^9, 
   3.9683285546879873`*^9},
 CellLabel->
  "In[205]:=",ExpressionUUID->"aff04eeb-05c7-46f8-af38-82c194aa92c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "2bcd2da3-50ad-4fd8-8460-3b2253cf57d9"],
 " form"
}], "Subsubsection",
 CellChangeTimes->{{3.9665019526365747`*^9, 3.966501954726963*^9}, {
  3.9665021386747837`*^9, 3.966502140961297*^9}, {3.967278694260714*^9, 
  3.967278694618558*^9}},ExpressionUUID->"8bb154f6-ce9d-4114-989e-\
75fe3f171518"],

Cell[TextData[{
 "To get any expression in ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "09501eea-804f-42fe-9f99-4cd4aec0e3f4"],
 " format use ",
 StyleBox["//TeXForm", "Input",
  FontWeight->"Bold"],
 ".\nThis may be useful to copy and paste the scalar potential or scattering \
matrices into your paper."
}], "Text",
 CellChangeTimes->{{3.966501981984665*^9, 3.966502028878848*^9}, {
  3.966502059719839*^9, 3.966502083773245*^9}, {3.9665021648746357`*^9, 
  3.966502221349873*^9}},ExpressionUUID->"33b9bce1-ef96-472c-bec2-\
23a285419b3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Potential4", "//", "TeXForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Basis", "[", 
    RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "//", "TeXForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScatteringMatrix", "[", 
    RowBox[{"Q", ",", "Y", ",", "T"}], "]"}], "//", "TeXForm"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.966502046304929*^9, 3.966502080504159*^9}, {
   3.966502577799556*^9, 3.966502590063775*^9}, 3.9665028125069227`*^9, 
   3.966503668223111*^9, {3.966505464210497*^9, 3.966505543328197*^9}, {
   3.9665100266679277`*^9, 3.9665100279301033`*^9}, {3.967267378861413*^9, 
   3.967267379900275*^9}, {3.96726799279672*^9, 3.967267997453128*^9}, {
   3.967268067527287*^9, 3.967268068447682*^9}, {3.967278463210606*^9, 
   3.967278463297471*^9}, {3.967278648052703*^9, 3.967278648075333*^9}, {
   3.9681281621877213`*^9, 3.968128163134406*^9}, 3.968130564919054*^9},
 CellLabel->
  "In[199]:=",ExpressionUUID->"12a5081b-6aa8-442f-9027-eb70ee332097"]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Local",
WindowSize->{1255, 916},
WindowMargins->{{1, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"8a9f81ac-cb8d-437e-89e7-04cf83a742b2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 216, 4, 40, "Input",ExpressionUUID->"2a149feb-678a-4f6c-ab55-ccc17a870748"],
Cell[CellGroupData[{
Cell[795, 28, 283, 4, 68, "Section",ExpressionUUID->"28b6a868-4742-4459-844c-91af904f030e"],
Cell[1081, 34, 824, 26, 32, "Text",ExpressionUUID->"291152ed-27b6-4395-a0d9-8df4f9ef1b87"],
Cell[1908, 62, 740, 16, 81, "Input",ExpressionUUID->"8fd86634-1e6a-499d-98c8-1badec29e86f"],
Cell[2651, 80, 712, 15, 76, "Text",ExpressionUUID->"879793e4-ca59-4a44-a8a5-fe2c1c2dd36c"],
Cell[3366, 97, 3468, 58, 183, "Input",ExpressionUUID->"7395b977-7b34-4199-9e3d-f44ed9474022"],
Cell[CellGroupData[{
Cell[6859, 159, 176, 3, 31, "Subsubsection",ExpressionUUID->"93fb7b7d-6fbf-42d8-bbb7-5ece7b7a7844"],
Cell[7038, 164, 256, 8, 32, "Text",ExpressionUUID->"b7de4ea8-4c16-465e-bf63-345f4d6dba9a"],
Cell[7297, 174, 743, 19, 101, "Input",ExpressionUUID->"d37d3dda-a86b-4a21-a88b-de555203e227"],
Cell[8043, 195, 206, 7, 32, "Text",ExpressionUUID->"6b84cab6-1722-46f9-b4f3-fb0933a68d76"],
Cell[8252, 204, 963, 25, 122, "Input",ExpressionUUID->"64aec836-15f0-4165-9374-11883e7060e4"],
Cell[9218, 231, 327, 10, 32, "Text",ExpressionUUID->"9297344d-d99f-45c1-8962-4626d0aa221f"],
Cell[9548, 243, 1511, 44, 244, "Input",ExpressionUUID->"961949fd-6a43-4eab-a93e-af3193b4fb97"],
Cell[11062, 289, 219, 4, 32, "Text",ExpressionUUID->"1e8ed4ae-a3e5-4a7a-a261-1ad9df08e742"],
Cell[11284, 295, 3495, 98, 415, "Input",ExpressionUUID->"a442e1ad-0fc6-46f3-9800-8fd854518628"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14828, 399, 265, 4, 68, "Section",ExpressionUUID->"b5ef7767-43ca-4a65-aefc-5f785965c1be"],
Cell[CellGroupData[{
Cell[15118, 407, 162, 3, 31, "Subsubsection",ExpressionUUID->"ae217f18-8b51-4364-bece-5e7e6102dc4c"],
Cell[15283, 412, 3175, 82, 203, "Input",ExpressionUUID->"ea65aed3-cad6-4346-b770-70b67d77a0a7"],
Cell[18461, 496, 12909, 344, 775, "Input",ExpressionUUID->"de2043ba-81d0-4d18-b95a-bf29fa465d6e"]
}, Closed]],
Cell[CellGroupData[{
Cell[31407, 845, 329, 5, 31, "Subsubsection",ExpressionUUID->"d7e3982d-4cf6-4f0b-84e2-985760608fda"],
Cell[31739, 852, 714, 13, 40, "Input",ExpressionUUID->"9241aab5-f4ba-4ef4-9ff0-e6b3eddd13d9"],
Cell[32456, 867, 5232, 141, 183, "Input",ExpressionUUID->"746d7e3a-a70e-4824-a2a5-72e12d00aee4"],
Cell[37691, 1010, 7887, 218, 285, "Input",ExpressionUUID->"e0fe434a-8191-45c3-904c-e42207434299"],
Cell[45581, 1230, 2623, 64, 183, "Input",ExpressionUUID->"c2fd99f7-eac7-494c-acb8-0819de2a1d4b"],
Cell[48207, 1296, 1042, 22, 40, "Input",ExpressionUUID->"cdef662b-71c9-4286-bbbf-daf908227af2"]
}, Closed]],
Cell[CellGroupData[{
Cell[49286, 1323, 169, 3, 31, "Subsubsection",ExpressionUUID->"3d593310-4b03-4e76-a34d-7bcf6eb4cd41"],
Cell[49458, 1328, 806, 15, 40, "Input",ExpressionUUID->"07c8681d-f216-40ac-b92a-a9aa54ca9780"],
Cell[50267, 1345, 4885, 121, 330, "Input",ExpressionUUID->"81fa116a-af6e-4e00-b80b-14cfcd2ba577"],
Cell[55155, 1468, 1550, 36, 101, "Input",ExpressionUUID->"a7fd7cc7-1ad9-4a64-9ffb-58d553b5cab2"],
Cell[56708, 1506, 3359, 88, 305, "Input",ExpressionUUID->"d1be6d5d-48e1-4dc2-a870-72ffb0fd52d9"],
Cell[60070, 1596, 9394, 175, 387, "Input",ExpressionUUID->"28565d23-0e86-4610-b632-2054c7248310"]
}, Closed]],
Cell[CellGroupData[{
Cell[69501, 1776, 346, 5, 31, "Subsubsection",ExpressionUUID->"e8a6ee27-fb06-401f-a1be-9872c3c962a4"],
Cell[69850, 1783, 564, 11, 40, "Input",ExpressionUUID->"574b08c4-cd93-4595-b076-5a75dba5ff7f"],
Cell[70417, 1796, 1741, 41, 150, "Input",ExpressionUUID->"aebacfe3-b370-4b78-b646-bf58bde1c687"],
Cell[72161, 1839, 595, 12, 40, "Input",ExpressionUUID->"c5cbf77b-9e9a-4c4b-a4de-4a291b2a43cd"]
}, Closed]],
Cell[CellGroupData[{
Cell[72793, 1856, 392, 6, 31, "Subsubsection",ExpressionUUID->"8513b58f-51c3-49eb-af20-8fba35809409"],
Cell[73188, 1864, 10728, 261, 583, "Input",ExpressionUUID->"2af6e305-eeb2-40ca-ad82-9cead9efdca5"]
}, Closed]],
Cell[CellGroupData[{
Cell[83953, 2130, 321, 5, 31, "Subsubsection",ExpressionUUID->"911bda91-4bea-4913-a86a-b74b41a4a8f9"],
Cell[84277, 2137, 5674, 133, 244, "Input",ExpressionUUID->"faa7b341-a854-47a1-8922-703cb6b8f938"]
}, Closed]],
Cell[CellGroupData[{
Cell[89988, 2275, 370, 5, 31, "Subsubsection",ExpressionUUID->"6bcf5a2b-8114-4134-84ad-b8f48ced84bc"],
Cell[90361, 2282, 10723, 261, 583, "Input",ExpressionUUID->"8d0857e3-528a-404c-b93e-0245be63ed75"]
}, Closed]],
Cell[CellGroupData[{
Cell[101121, 2548, 388, 6, 31, "Subsubsection",ExpressionUUID->"7ffa1256-248f-4b17-b47b-12c2dfdf6581"],
Cell[101512, 2556, 2999, 84, 203, "Input",ExpressionUUID->"c2663a8d-dbd7-463b-9d4a-a69ee5bf8bc8"],
Cell[104514, 2642, 6190, 149, 288, "Input",ExpressionUUID->"f3100729-5b39-4a23-ac98-07bf699286e1"],
Cell[110707, 2793, 3500, 89, 275, "Input",ExpressionUUID->"5449eaf6-7630-45ca-a553-cb1ec356f636"],
Cell[114210, 2884, 3450, 89, 275, "Input",ExpressionUUID->"dcde26bc-6765-40cf-8810-c7ef67245165"],
Cell[117663, 2975, 4102, 82, 142, "Input",ExpressionUUID->"d107637b-6208-4179-852a-d758396cfe29"],
Cell[121768, 3059, 1447, 39, 122, "Input",ExpressionUUID->"f3a96f46-0573-491f-a0aa-5fd6865431aa"]
}, Closed]],
Cell[CellGroupData[{
Cell[123252, 3103, 444, 6, 31, "Subsubsection",ExpressionUUID->"4ab21135-55d4-446e-a7e8-00a86a5558b7"],
Cell[123699, 3111, 7427, 172, 408, "Input",ExpressionUUID->"80e09e97-efbe-44b2-829c-c0b21b6ee1de"]
}, Closed]],
Cell[CellGroupData[{
Cell[131163, 3288, 392, 6, 31, "Subsubsection",ExpressionUUID->"50849b2f-fd45-48d4-9366-5e527df879b6"],
Cell[131558, 3296, 5409, 125, 244, "Input",ExpressionUUID->"ed835bd6-c056-45f8-9edf-cab5198e58bf"]
}, Closed]],
Cell[CellGroupData[{
Cell[137004, 3426, 434, 6, 31, "Subsubsection",ExpressionUUID->"3446b21b-5e87-48ee-9f30-f92a7061c0b8"],
Cell[137441, 3434, 4677, 120, 340, "Input",ExpressionUUID->"f3a32590-3c06-4712-a9e0-63eff6ba075b"],
Cell[142121, 3556, 6360, 151, 301, "Input",ExpressionUUID->"8c5fbb83-0721-45f2-900e-e410b10b576c"],
Cell[148484, 3709, 6610, 163, 384, "Input",ExpressionUUID->"6c63508f-1518-4a24-ac10-4846fe4e4fe5"],
Cell[155097, 3874, 6193, 157, 328, "Input",ExpressionUUID->"47c55e24-c5e0-49d5-93b8-a8d52a0c507d"],
Cell[161293, 4033, 9597, 220, 480, "Input",ExpressionUUID->"594a91aa-5b16-4725-a810-ee29d72236cf"],
Cell[170893, 4255, 1522, 40, 122, "Input",ExpressionUUID->"f5c00e9a-fbe8-45fe-b919-f36c7fc7a7ba"]
}, Closed]],
Cell[CellGroupData[{
Cell[172452, 4300, 327, 5, 31, "Subsubsection",ExpressionUUID->"8d773dba-d959-4de6-bfdd-9f60d7c0d8cb"],
Cell[172782, 4307, 4738, 119, 469, "Input",ExpressionUUID->"5cf50b07-db40-4f3d-85a7-d771941b33b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[177557, 4431, 224, 4, 31, "Subsubsection",ExpressionUUID->"01fbd97c-b15f-42fa-b5a8-ffe64f5d314a"],
Cell[177784, 4437, 9867, 230, 714, "Input",ExpressionUUID->"45ec185a-2707-4a44-8b47-f39dd6ae0100"]
}, Closed]],
Cell[CellGroupData[{
Cell[187688, 4672, 210, 3, 31, "Subsubsection",ExpressionUUID->"de581518-5954-49c5-8cdd-a25535bc65e4"],
Cell[187901, 4677, 299, 7, 40, "Input",ExpressionUUID->"fa48e254-f1db-4618-bc55-2771b681c8f6"],
Cell[188203, 4686, 1707, 30, 40, "Input",ExpressionUUID->"03247b01-51ff-4ed9-b6e6-63e41de098c3"],
Cell[189913, 4718, 2949, 66, 203, "Input",ExpressionUUID->"e72abbc0-6e62-40f0-acd3-4b0e30d43a07"],
Cell[192865, 4786, 2634, 56, 203, "Input",ExpressionUUID->"8a19379f-a06f-4eff-baec-2be14356133e"],
Cell[195502, 4844, 2736, 59, 203, "Input",ExpressionUUID->"b096b75a-6288-4138-bd88-2c19ba5ecc12"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[198287, 4909, 351, 5, 54, "Section",ExpressionUUID->"a51a7701-85df-4352-babe-521d55b1c58e"],
Cell[CellGroupData[{
Cell[198663, 4918, 423, 6, 31, "Subsubsection",ExpressionUUID->"14ac4c48-1f03-4b82-a20f-5b5d6b138690"],
Cell[199089, 4926, 616, 10, 40, "Input",ExpressionUUID->"afa56673-74b8-4b86-9cbe-6e512ca3d288"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199742, 4941, 219, 4, 31, "Subsubsection",ExpressionUUID->"2c922450-1896-467a-b006-0753d1aeb550"],
Cell[199964, 4947, 1158, 28, 58, "Text",ExpressionUUID->"dfa925ad-2aa4-4bc3-9f90-56e2eba72f1a"],
Cell[201125, 4977, 1525, 28, 142, "Input",ExpressionUUID->"8a7564df-1b39-4171-8fff-d8d51acd44f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202687, 5010, 162, 3, 31, "Subsubsection",ExpressionUUID->"d88f10f1-8d18-4efe-9d57-4a9dbc7de56d"],
Cell[202852, 5015, 1024, 27, 58, "Text",ExpressionUUID->"e43662bf-9b24-40e7-b5e7-8b3df20c7259"],
Cell[203879, 5044, 1179, 23, 122, "Input",ExpressionUUID->"aff04eeb-05c7-46f8-af38-82c194aa92c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205095, 5072, 685, 20, 31, "Subsubsection",ExpressionUUID->"8bb154f6-ce9d-4114-989e-75fe3f171518"],
Cell[205783, 5094, 873, 25, 54, "Text",ExpressionUUID->"33b9bce1-ef96-472c-bec2-23a285419b3f"],
Cell[206659, 5121, 1296, 30, 162, "Input",ExpressionUUID->"12a5081b-6aa8-442f-9027-eb70ee332097"]
}, Open  ]]
}, Open  ]]
}
]
*)

